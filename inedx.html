<!DOCTYPE html>

<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨ Ø§Ù„Ø´Ø§Ù…Ù„ - 1448 Ù‡Ù€</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800;900&family=Amiri:wght@400;700&display=swap" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<!-- Firebase SDK -->

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<style>
:root {
  --navy:    #0a2463;
  --blue:    #1e5ef3;
  --blue-md: #3a7bff;
  --blue-lt: #e8f0ff;
  --blue-xs: #f3f7ff;
  --sky:     #7eb5ff;
  --teal:    #14b8a6;
  --teal-lt: #ccfbf1;
  --present: #16a34a;
  --present-lt: #dcfce7;
  --absent:  #dc2626;
  --absent-lt: #fee2e2;
  --excused: #d97706;
  --excused-lt: #fef3c7;
  --late:    #7c3aed;
  --late-lt: #ede9fe;
  --gray-50: #f8faff;
  --gray-100:#eef2fb;
  --gray-200:#dde5f7;
  --gray-400:#8fa8d6;
  --gray-600:#4a6080;
  --gray-800:#1c2b45;
  --white:   #ffffff;
  --shadow-sm: 0 2px 8px rgba(10,36,99,.07);
  --shadow-md: 0 6px 24px rgba(10,36,99,.12);
  --shadow-lg: 0 16px 48px rgba(10,36,99,.16);
  --radius: 16px;
  --grade1: #3b82f6;
  --grade2: #8b5cf6;
  --grade3: #ec4899;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Cairo',sans-serif;background:var(--gray-50);color:var(--gray-800);direction:rtl;min-height:100vh}

/* â”€â”€ HEADER â”€â”€ */
.header{
  background:linear-gradient(135deg,var(--navy) 0%,#0d3080 50%,#1a52c3 100%);
  padding:24px 32px;
  position:relative;overflow:hidden;
}
.header::before{
  content:'';position:absolute;top:-80px;left:-80px;
  width:300px;height:300px;border-radius:50%;
  background:rgba(255,255,255,.04);pointer-events:none;
}
.header::after{
  content:'';position:absolute;bottom:-60px;right:10%;
  width:200px;height:200px;border-radius:50%;
  background:rgba(126,181,255,.07);pointer-events:none;
}
.header-dots{
  position:absolute;inset:0;
  background-image:radial-gradient(circle,rgba(255,255,255,.06) 1px,transparent 1px);
  background-size:22px 22px;pointer-events:none;
}
.header-inner{
  display:flex;align-items:center;justify-content:space-between;
  flex-wrap:wrap;gap:16px;position:relative;z-index:1;
}
.header-left{}
.header-badge{
  display:inline-flex;align-items:center;gap:7px;
  background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.2);
  border-radius:100px;padding:5px 14px;margin-bottom:10px;
  font-size:11px;font-weight:700;color:rgba(255,255,255,.85);letter-spacing:.5px;
}
.header-title{font-size:26px;font-weight:900;color:#3a7bff;line-height:1.2;margin-bottom:4px;text-shadow:0 2px 4px rgba(0,0,0,.2)}
.header-sub{font-size:13px;color:rgba(255,255,255,.6);font-weight:500}
.header-right{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.header-stat{
  background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.15);
  border-radius:12px;padding:12px 20px;text-align:center;min-width:80px;
  backdrop-filter:blur(8px);
}
.header-stat .sv{font-size:22px;font-weight:900;color:#fff;line-height:1}
.header-stat .sl{font-size:10px;color:rgba(255,255,255,.6);margin-top:3px}

.user-badge{
  background:rgba(255,255,255,.15);
  border:1px solid rgba(255,255,255,.25);
  border-radius:12px;
  padding:8px 14px;
  display:flex;
  align-items:center;
  gap:8px;
  cursor:pointer;
  transition:all .2s;
}
.user-badge:hover{background:rgba(255,255,255,.2)}
.user-avatar{
  width:28px;height:28px;
  border-radius:50%;
  background:linear-gradient(135deg,#3a7bff,#7eb5ff);
  display:flex;align-items:center;justify-content:center;
  font-size:11px;font-weight:800;color:#fff;
}
.user-name{font-size:11px;font-weight:700;color:#fff}
.user-role{font-size:9px;color:rgba(255,255,255,.6)}

/* â”€â”€ TABS â”€â”€ */
.tabs-bar{
  display:flex;gap:4px;padding:16px 32px 0;
  background:#fff;border-bottom:1px solid var(--gray-200);
  position:sticky;top:0;z-index:50;
}
.tab-btn{
  padding:10px 20px;border-radius:12px 12px 0 0;
  font-family:'Cairo',sans-serif;font-size:13px;font-weight:700;
  cursor:pointer;transition:all .2s;color:var(--gray-400);
  border:none;background:none;border-bottom:3px solid transparent;
}
.tab-btn.active{color:var(--blue);border-bottom-color:var(--blue);background:var(--blue-xs)}
.tab-btn:not(.active):hover{color:var(--navy);background:var(--gray-100)}

/* â”€â”€ PAGES â”€â”€ */
.page{display:none;padding:24px 32px 40px}
.page.active{display:block}

/* â”€â”€ STUDENT MANAGER STYLES â”€â”€ */
.mgr-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px}
.mgr-card{
  background:#fff;
  border-radius:var(--radius);
  border:1px solid var(--gray-200);
  box-shadow:var(--shadow-sm);
  padding:20px;
}
.mgr-card-title{
  font-size:16px;
  font-weight:800;
  color:var(--navy);
  margin-bottom:16px;
  display:flex;
  align-items:center;
  gap:8px;
}
.form-grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:12px;
  margin-bottom:12px;
}
.form-group{
  display:flex;
  flex-direction:column;
  gap:6px;
}
.form-label{
  font-size:11px;
  font-weight:700;
  color:var(--gray-600);
}
.form-input,.form-select{
  padding:10px 14px;
  border:1.5px solid var(--gray-200);
  border-radius:10px;
  font-family:'Cairo',sans-serif;
  font-size:13px;
  outline:none;
  transition:all .2s;
}
.form-input:focus,.form-select:focus{
  border-color:var(--blue);
  box-shadow:0 0 0 3px rgba(30,94,243,.1);
}
.btn{
  padding:9px 18px;border-radius:10px;
  font-family:'Cairo',sans-serif;font-size:12px;font-weight:700;
  cursor:pointer;display:flex;align-items:center;gap:6px;
  transition:all .2s;border:none;
}
.btn-primary{background:linear-gradient(135deg,var(--blue),#0d3aaa);color:#fff;box-shadow:0 3px 12px rgba(30,94,243,.3)}
.btn-primary:hover{transform:translateY(-1px);box-shadow:0 5px 16px rgba(30,94,243,.4)}
.btn-outline{background:#fff;color:var(--blue);border:1.5px solid var(--blue-lt)}
.btn-outline:hover{background:var(--blue-xs)}
.btn-success{background:linear-gradient(135deg,var(--present),#15803d);color:#fff}
.btn-danger{background:linear-gradient(135deg,var(--absent),#b91c1c);color:#fff}

.students-list{
  max-height:500px;
  overflow-y:auto;
}
.student-item{
  display:flex;
  align-items:center;
  gap:12px;
  padding:12px;
  background:var(--gray-50);
  border-radius:10px;
  margin-bottom:8px;
  transition:all .2s;
}
.student-item:hover{
  background:var(--blue-lt);
  transform:translateX(-3px);
}
.student-avatar{
  width:40px;
  height:40px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:800;
  color:#fff;
  font-size:14px;
  flex-shrink:0;
}
.student-info{
  flex:1;
}
.student-name{
  font-size:13px;
  font-weight:700;
  color:var(--navy);
  margin-bottom:2px;
}
.student-meta{
  font-size:10px;
  color:var(--gray-600);
}
.student-actions{
  display:flex;
  gap:6px;
}
.btn-icon{
  width:32px;
  height:32px;
  border-radius:8px;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  border:none;
  transition:all .2s;
  font-size:13px;
}
.btn-edit{background:var(--blue-lt);color:var(--blue)}
.btn-delete{background:var(--absent-lt);color:var(--absent)}

.import-area{
  border:2px dashed var(--gray-200);
  border-radius:12px;
  padding:20px;
  background:var(--gray-50);
  margin-bottom:12px;
}
.import-area textarea{
  width:100%;
  min-height:120px;
  padding:12px;
  border:1.5px solid var(--gray-200);
  border-radius:10px;
  font-family:'Cairo',sans-serif;
  font-size:12px;
  margin-top:10px;
  resize:vertical;
  outline:none;
}
.import-area textarea:focus{
  border-color:var(--blue);
  box-shadow:0 0 0 3px rgba(30,94,243,.1);
}

.output-box{
  background:var(--gray-800);
  color:#fff;
  padding:16px;
  border-radius:12px;
  font-family:'Courier New',monospace;
  font-size:11px;
  max-height:300px;
  overflow-y:auto;
  direction:ltr;
  text-align:left;
}
.output-box pre{
  margin:0;
  white-space:pre-wrap;
  word-wrap:break-word;
}

.counter{
  text-align:center;
  padding:16px;
  background:linear-gradient(135deg,var(--blue-xs),var(--blue-lt));
  border-radius:12px;
  margin-bottom:20px;
}
.counter-num{
  font-size:32px;
  font-weight:900;
  color:var(--blue);
  margin-bottom:4px;
}
.counter-label{
  font-size:12px;
  color:var(--gray-600);
  font-weight:600;
}

@media(max-width:900px){
  .mgr-grid{grid-template-columns:1fr}
  .form-grid{grid-template-columns:1fr}
}

@media(max-width:768px){
  div[style*="grid-template-columns:1fr auto 1fr"]{
    grid-template-columns:1fr!important;
    text-align:center!important;
  }
  div[style*="text-align:left"]{
    text-align:center!important;
  }
  div[style*="text-align:right"]{
    text-align:center!important;
  }
}

/* â”€â”€ PRINT STYLES â”€â”€ */
@media print {
  body{background:#fff}
  .tabs-bar,.user-badge,.btn{display:none}
  .header{background:#fff!important;color:#000!important;border-bottom:3px solid #14b8a6}
  .header-title,.header-sub{color:#000!important}
  .header-badge{display:none}
  @page {
    margin:2cm;
    size:A4;
  }
}
</style>

</head>
<body>

<!-- â•â• LOGIN MODAL â•â• -->

<div id="loginModal" style="position:fixed;inset:0;background:rgba(10,36,99,.85);backdrop-filter:blur(8px);z-index:9999;display:flex;align-items:center;justify-content:center">
  <div style="background:#fff;border-radius:20px;padding:40px;width:90%;max-width:450px;box-shadow:0 20px 60px rgba(0,0,0,.3)">
    <div style="text-align:center;margin-bottom:30px">
      <div style="width:80px;height:80px;background:linear-gradient(135deg,var(--blue),var(--navy));border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 16px;font-size:36px">ğŸ”</div>
      <h2 style="font-size:24px;font-weight:900;color:var(--navy);margin-bottom:8px">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
      <p style="font-size:13px;color:var(--gray-600)">Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨ - Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¨Ø¬Ø§Ø²Ø§Ù†</p>
    </div>

```
<div style="margin-bottom:24px">
  <label style="display:block;font-size:12px;font-weight:700;color:var(--gray-600);margin-bottom:8px">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ</label>
  <input type="password" id="passwordInput" placeholder="Ø£Ø¯Ø®Ù„ÙŠ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ..." 
         style="width:100%;padding:14px 16px;border:2px solid var(--gray-200);border-radius:12px;font-family:'Cairo',sans-serif;font-size:14px;outline:none;transition:all .2s"
         onkeypress="if(event.key==='Enter')attemptLogin()"
         onfocus="this.style.borderColor='var(--blue)';this.style.boxShadow='0 0 0 3px rgba(30,94,243,.1)'"
         onblur="this.style.borderColor='var(--gray-200)';this.style.boxShadow='none'">
  <div id="loginError" style="display:none;margin-top:8px;padding:10px;background:var(--absent-lt);color:var(--absent);border-radius:8px;font-size:12px;font-weight:600"></div>
</div>

<button onclick="attemptLogin()" style="width:100%;padding:14px;background:linear-gradient(135deg,var(--blue),var(--navy));color:#fff;border:none;border-radius:12px;font-family:'Cairo',sans-serif;font-size:14px;font-weight:700;cursor:pointer;transition:all .2s;margin-bottom:16px"
        onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 8px 20px rgba(30,94,243,.3)'"
        onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
  ğŸ”“ Ø¯Ø®ÙˆÙ„
</button>

<button onclick="enterViewMode()" style="width:100%;padding:12px;background:var(--gray-100);color:var(--gray-600);border:none;border-radius:12px;font-family:'Cairo',sans-serif;font-size:13px;font-weight:600;cursor:pointer;transition:all .2s"
        onmouseover="this.style.background='var(--gray-200)'"
        onmouseout="this.style.background='var(--gray-100)'">
  ğŸ‘ï¸ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø·
</button>

<div style="margin-top:20px;padding-top:20px;border-top:1px solid var(--gray-200);text-align:center">
  <p style="font-size:11px;color:var(--gray-400);margin-bottom:8px">ğŸ’¡ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠØŒ ØªÙˆØ§ØµÙ„ÙŠ Ù…Ø¹ Ø§Ù„Ù…Ø´Ø±ÙØ©</p>
  <p style="font-size:10px;color:var(--gray-400)">Ø£. Ø¹ÙŠØ´Ø© Ø¹ÙˆØ§Ø¬ÙŠ - ÙˆÙƒÙŠÙ„Ø© Ø´Ø¤ÙˆÙ† Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª</p>
</div>
```

  </div>
</div>

<!-- â•â• VIEW MODE OVERLAY â•â• -->

<div id="viewModeOverlay" style="display:none;position:fixed;bottom:0;left:0;right:0;background:linear-gradient(135deg,#f59e0b,#d97706);padding:12px 20px;z-index:100;box-shadow:0 -4px 12px rgba(0,0,0,.1)">
  <div style="display:flex;align-items:center;justify-content:space-between;max-width:1400px;margin:0 auto">
    <div style="display:flex;align-items:center;gap:10px">
      <span style="font-size:20px">ğŸ‘ï¸</span>
      <div>
        <div style="font-size:13px;font-weight:800;color:#fff">ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø·</div>
        <div style="font-size:10px;color:rgba(255,255,255,.8)">Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ÙˆØ¶Ø¹</div>
      </div>
    </div>
    <button onclick="logout()" style="padding:8px 16px;background:rgba(255,255,255,.2);border:1px solid rgba(255,255,255,.3);border-radius:8px;color:#fff;font-family:'Cairo',sans-serif;font-size:11px;font-weight:700;cursor:pointer;transition:all .2s"
            onmouseover="this.style.background='rgba(255,255,255,.3)'"
            onmouseout="this.style.background='rgba(255,255,255,.2)'">
      ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬
    </button>
  </div>
</div>

<!-- â•â• OFFICIAL HEADER â•â• -->

<div style="background:#fff;border-bottom:3px solid #14b8a6;padding:24px 32px">
  <div style="text-align:center">
    <div style="font-size:16px;font-weight:800;color:#14b8a6;margin-bottom:3px">Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</div>
    <div style="font-size:18px;font-weight:900;color:#1a1a1a;margin-bottom:3px">ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…</div>
    <div style="font-size:14px;font-weight:600;color:#4a6080;margin-bottom:3px">Ø¥Ø¯Ø§Ø±Ø© ØªØ¹Ù„ÙŠÙ… Ø¬Ø§Ø²Ø§Ù†</div>
    <div style="font-size:14px;font-weight:700;color:#0a2463">Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¨Ø¬Ø§Ø²Ø§Ù†</div>
  </div>
</div>

<!-- â•â• HEADER â•â• -->

<div class="header">
  <div class="header-dots"></div>
  <div class="header-inner">
    <div class="header-left">
      <div class="header-badge">ğŸ“‹ Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨</div>
      <div class="header-title">Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</div>
      <div class="header-sub">Ù…Ø¯ÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©: Ø£. Ù‡Ø¨Ù‡ ØµÙ… â€¢ Ø£. Ø¹ÙŠØ´Ø© Ø¹ÙˆØ§Ø¬ÙŠ (ÙˆÙƒÙŠÙ„Ø© Ø´Ø¤ÙˆÙ† Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª) â€¢ Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØªØµÙ…ÙŠÙ…: Ø£. Ù†Ø¹Ù…Ù‡ ÙØ§Ø¦Ø¹ Ø¹Ø³ÙŠØ±ÙŠ â€¢ Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ 1447-1448 Ù‡Ù€</div>
    </div>
    <div class="header-right">
      <div id="headerStats"></div>
    </div>
  </div>
</div>

<!-- â•â• TABS â•â• -->

<div class="tabs-bar">
  <button class="tab-btn active" onclick="showTab('register')">ğŸ“‹ Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±</button>
  <button class="tab-btn" onclick="showTab('students')">ğŸ‘©â€ğŸ“ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª</button>
  <button class="tab-btn" onclick="showTab('reports')">ğŸ“Š Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ©</button>
  <button class="tab-btn" onclick="showTab('certificates')">ğŸ† Ø´Ù‡Ø§Ø¯Ø§Øª Ø§Ù„Ø´ÙƒØ±</button>
  <button class="tab-btn" onclick="showTab('parents')">ğŸ“± Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±</button>
  <button class="tab-btn" onclick="showTab('letters')">âœ‰ï¸ Ø®Ø·Ø§Ø¨Ø§Øª Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±</button>
  <button class="tab-btn" onclick="showTab('admin')">ğŸ‘¥ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB: REGISTER â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<div id="tab-register" class="page active">
  <h2 style="font-size:22px;font-weight:900;color:var(--navy);margin-bottom:20px">
    ğŸ“‹ Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨ - Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠ (29 Ø±Ø¬Ø¨ 1448 Ù‡Ù€)
  </h2>

  <!-- Controls -->

  <div style="background:#fff;padding:16px 20px;border-radius:12px;border:1px solid var(--gray-200);margin-bottom:20px;display:flex;gap:12px;align-items:center;flex-wrap:wrap">
    <div style="display:flex;align-items:center;gap:8px">
      <span style="font-size:11px;font-weight:700;color:var(--gray-600)">Ø§Ù„ØµÙ:</span>
      <select class="form-select" id="registerGrade" onchange="updateAttendanceTable()">
        <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙÙˆÙ</option>
        <option value="first">Ø§Ù„Ø£ÙˆÙ„ Ø«Ø§Ù†ÙˆÙŠ</option>
        <option value="second">Ø§Ù„Ø«Ø§Ù†ÙŠ Ø«Ø§Ù†ÙˆÙŠ</option>
        <option value="third">Ø§Ù„Ø«Ø§Ù„Ø« Ø«Ø§Ù†ÙˆÙŠ</option>
      </select>
    </div>
    <div style="display:flex;align-items:center;gap:8px">
      <span style="font-size:11px;font-weight:700;color:var(--gray-600)">Ø§Ù„Ø´Ø¹Ø¨Ø©:</span>
      <select class="form-select" id="registerSection" onchange="updateAttendanceTable()">
        <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ø¹Ø¨</option>
        <option value="Ù¡">Ø´Ø¹Ø¨Ø© Ù¡</option>
        <option value="Ù¢">Ø´Ø¹Ø¨Ø© Ù¢</option>
        <option value="Ù£">Ø´Ø¹Ø¨Ø© Ù£</option>
        <option value="Ù¤">Ø´Ø¹Ø¨Ø© Ù¤</option>
        <option value="Ù¥">Ø´Ø¹Ø¨Ø© Ù¥</option>
      </select>
    </div>
    <div style="margin-right:auto;display:flex;gap:8px">
      <button class="btn btn-outline" onclick="updateAttendanceTable()" style="display:flex;align-items:center;gap:6px;transition:all .2s" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
        <span style="font-size:16px">ğŸ”„</span>
        <span>ØªØ­Ø¯ÙŠØ«</span>
      </button>
      <button class="btn btn-primary" onclick="exportAttendanceExcel()">ğŸ“¥ ØªØµØ¯ÙŠØ± Excel</button>
    </div>
  </div>

  <!-- Quick Attendance Methods -->

  <div style="background:linear-gradient(135deg,var(--blue-xs),var(--blue-lt));padding:24px;border-radius:16px;border:2px solid var(--blue);margin-bottom:24px">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px">
      <h3 style="font-size:16px;font-weight:800;color:var(--navy);display:flex;align-items:center;gap:10px">
        <span style="background:var(--blue);width:32px;height:32px;border-radius:10px;display:inline-flex;align-items:center;justify-content:center;font-size:16px;color:#fff">âš¡</span>
        Ø·Ø±Ù‚ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ø³Ø±ÙŠØ¹
      </h3>
      <span style="font-size:11px;color:var(--gray-600);font-weight:600">Ø§Ø®ØªØ± Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©</span>
    </div>

```
<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px">
  <!-- QR Scanner -->
  <button class="attendance-method-btn" onclick="openQRScanner()" style="background:#fff;border:2px solid var(--teal);padding:20px;border-radius:12px;cursor:pointer;transition:all .2s;display:flex;flex-direction:column;align-items:center;gap:12px;font-family:'Cairo',sans-serif" onmouseover="this.style.transform='translateY(-4px)';this.style.boxShadow='var(--shadow-md)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
    <div style="width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,var(--teal),#0d9488);display:flex;align-items:center;justify-content:center;font-size:28px;color:#fff">ğŸ“¸</div>
    <div style="font-size:14px;font-weight:700;color:var(--navy)">Ù…Ø³Ø­ QR Code</div>
    <div style="font-size:11px;color:var(--gray-600);text-align:center">Ù…Ø³Ø­ Ø±Ù…Ø² Ø§Ù„Ø·Ø§Ù„Ø¨Ø©</div>
  </button>
  
  <!-- Manual Entry -->
  <button class="attendance-method-btn" onclick="openManualEntry()" style="background:#fff;border:2px solid var(--blue);padding:20px;border-radius:12px;cursor:pointer;transition:all .2s;display:flex;flex-direction:column;align-items:center;gap:12px;font-family:'Cairo',sans-serif" onmouseover="this.style.transform='translateY(-4px)';this.style.boxShadow='var(--shadow-md)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
    <div style="width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,var(--blue),var(--navy));display:flex;align-items:center;justify-content:center;font-size:28px;color:#fff">ğŸ“‹</div>
    <div style="font-size:14px;font-weight:700;color:var(--navy)">ØªØ³Ø¬ÙŠÙ„ ÙŠØ¯ÙˆÙŠ</div>
    <div style="font-size:11px;color:var(--gray-600);text-align:center">Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ ÙŠØ¯ÙˆÙŠØ§Ù‹</div>
  </button>
  
  <!-- Voice Input -->
  <button class="attendance-method-btn" onclick="openVoiceInput()" style="background:#fff;border:2px solid var(--late);padding:20px;border-radius:12px;cursor:pointer;transition:all .2s;display:flex;flex-direction:column;align-items:center;gap:12px;font-family:'Cairo',sans-serif" onmouseover="this.style.transform='translateY(-4px)';this.style.boxShadow='var(--shadow-md)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
    <div style="width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,var(--late),#6d28d9);display:flex;align-items:center;justify-content:center;font-size:28px;color:#fff">ğŸ¤</div>
    <div style="font-size:14px;font-weight:700;color:var(--navy)">ØªØ³Ø¬ÙŠÙ„ ØµÙˆØªÙŠ</div>
    <div style="font-size:11px;color:var(--gray-600);text-align:center">Ø¥Ù…Ù„Ø§Ø¡ ØµÙˆØªÙŠ</div>
  </button>
  
  <!-- Quick List -->
  <button class="attendance-method-btn" onclick="openQuickList()" style="background:#fff;border:2px solid var(--present);padding:20px;border-radius:12px;cursor:pointer;transition:all .2s;display:flex;flex-direction:column;align-items:center;gap:12px;font-family:'Cairo',sans-serif" onmouseover="this.style.transform='translateY(-4px)';this.style.boxShadow='var(--shadow-md)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
    <div style="width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,var(--present),#15803d);display:flex;align-items:center;justify-content:center;font-size:28px;color:#fff">â˜‘ï¸</div>
    <div style="font-size:14px;font-weight:700;color:var(--navy)">Ù‚Ø§Ø¦Ù…Ø© Ø³Ø±ÙŠØ¹Ø©</div>
    <div style="font-size:11px;color:var(--gray-600);text-align:center">ØªØ­Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</div>
  </button>
</div>
```

  </div>

  <!-- Attendance Table -->

  <div id="attendanceTableContainer"></div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB: STUDENT MANAGER â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<div id="tab-students" class="page">
  <h2 style="font-size:22px;font-weight:900;color:var(--navy);margin-bottom:20px">
    ğŸ‘©â€ğŸ“ Ø¥Ø¯Ø§Ø±Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª
  </h2>

  <div class="counter">
    <div class="counter-num" id="studentCount">0</div>
    <div class="counter-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø³Ø¬Ù„Ø§Øª</div>
  </div>

  <div class="mgr-grid">
    <!-- Add Single Student -->
    <div class="mgr-card">
      <div class="mgr-card-title">â• Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©</div>
      <div class="form-grid">
        <div class="form-group" style="grid-column:1/-1">
          <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨Ø© Ø§Ù„ÙƒØ§Ù…Ù„</label>
          <input type="text" class="form-input" id="studentName" placeholder="Ù…Ø«Ø§Ù„: Ø³Ø§Ø±Ø© Ø£Ø­Ù…Ø¯ Ø§Ù„Ù…Ø§Ù„ÙƒÙŠ"/>
        </div>
        <div class="form-group">
          <label class="form-label">Ø§Ù„ØµÙ</label>
          <select class="form-select" id="studentGrade">
            <option value="first">Ø§Ù„Ø£ÙˆÙ„ Ø«Ø§Ù†ÙˆÙŠ</option>
            <option value="second">Ø§Ù„Ø«Ø§Ù†ÙŠ Ø«Ø§Ù†ÙˆÙŠ</option>
            <option value="third">Ø§Ù„Ø«Ø§Ù„Ø« Ø«Ø§Ù†ÙˆÙŠ</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Ø§Ù„Ø´Ø¹Ø¨Ø©</label>
          <select class="form-select" id="studentSection">
            <option value="Ù¡">Ø´Ø¹Ø¨Ø© Ù¡</option>
            <option value="Ù¢">Ø´Ø¹Ø¨Ø© Ù¢</option>
            <option value="Ù£">Ø´Ø¹Ø¨Ø© Ù£</option>
            <option value="Ù¤">Ø´Ø¹Ø¨Ø© Ù¤</option>
            <option value="Ù¥">Ø´Ø¹Ø¨Ø© Ù¥</option>
          </select>
        </div>
        <div class="form-group" style="grid-column:1/-1">
          <label class="form-label">ğŸ“± Ø±Ù‚Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
          <input type="tel" class="form-input" id="parentPhone" placeholder="Ù…Ø«Ø§Ù„: 0551234567 Ø£Ùˆ 00966551234567" dir="ltr" style="text-align:left"/>
          <div style="font-size:11px;color:var(--gray-600);margin-top:4px">ğŸ’¡ Ø³ÙŠÙØ³ØªØ®Ø¯Ù… Ù„Ù„ØªÙˆØ§ØµÙ„ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ø£Ùˆ Ø±Ø³Ø§Ø¦Ù„ Ù†ØµÙŠØ©</div>
        </div>
      </div>
      <div style="display:flex;gap:10px;margin-top:12px">
        <button class="btn btn-primary" onclick="addStudent()">â• Ø¥Ø¶Ø§ÙØ©</button>
        <button class="btn btn-outline" onclick="clearForm()">ğŸ”„ Ù…Ø³Ø­</button>
      </div>
    </div>

```
<!-- Import Bulk -->
<div class="mgr-card">
  <div class="mgr-card-title">ğŸ“¥ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¹Ø¯Ø© Ø·Ø§Ù„Ø¨Ø§Øª</div>
  <div class="import-area">
    <div style="font-size:11px;color:var(--gray-600);margin-bottom:8px">
      Ø§Ù„ØµÙ‚ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª (Ø§Ø³Ù… ÙˆØ§Ø­Ø¯ ÙÙŠ ÙƒÙ„ Ø³Ø·Ø±)
    </div>
    <textarea id="bulkImport" placeholder="Ø³Ø§Ø±Ø© Ø£Ø­Ù…Ø¯ Ø§Ù„Ù…Ø§Ù„ÙƒÙŠ&#10;Ù†ÙˆØ±Ø§ Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹ØªÙŠØ¨ÙŠ&#10;Ø±ÙŠÙ… Ù…Ø­Ù…Ø¯ Ø§Ù„Ø¯ÙˆØ³Ø±ÙŠ"></textarea>
  </div>
  <div style="display:flex;gap:10px;align-items:center">
    <select class="form-select" id="bulkGrade" style="flex:1">
      <option value="first">Ø§Ù„Ø£ÙˆÙ„ Ø«Ø§Ù†ÙˆÙŠ</option>
      <option value="second">Ø§Ù„Ø«Ø§Ù†ÙŠ Ø«Ø§Ù†ÙˆÙŠ</option>
      <option value="third">Ø§Ù„Ø«Ø§Ù„Ø« Ø«Ø§Ù†ÙˆÙŠ</option>
    </select>
    <select class="form-select" id="bulkSection" style="width:100px">
      <option value="Ù¡">Ø´Ø¹Ø¨Ø© Ù¡</option>
      <option value="Ù¢">Ø´Ø¹Ø¨Ø© Ù¢</option>
      <option value="Ù£">Ø´Ø¹Ø¨Ø© Ù£</option>
      <option value="Ù¤">Ø´Ø¹Ø¨Ø© Ù¤</option>
      <option value="Ù¥">Ø´Ø¹Ø¨Ø© Ù¥</option>
    </select>
    <button class="btn btn-primary" onclick="importBulk()">ğŸ“¥ Ø§Ø³ØªÙŠØ±Ø§Ø¯</button>
  </div>
</div>
```

  </div>

  <!-- Students List -->

  <div class="mgr-card">
    <div class="mgr-card-title" style="justify-content:space-between">
      <span>ğŸ‘¥ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø³Ø¬Ù„Ø§Øª</span>
      <div style="display:flex;gap:8px">
        <button class="btn btn-outline" onclick="clearAll()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
        <button class="btn btn-success" onclick="applyToSystem()">âœ… ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù…</button>
      </div>
    </div>
    <div class="students-list" id="studentsList"></div>
  </div>

  <!-- Export Code (Hidden by default) -->

  <div class="mgr-card" style="display:none">
    <div class="mgr-card-title" style="justify-content:space-between">
      <span>ğŸ’» ÙƒÙˆØ¯ Ø§Ù„ØªØµØ¯ÙŠØ±</span>
      <button class="btn btn-primary" onclick="copyCode()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯</button>
    </div>
    <div class="output-box" id="outputCode">
      <pre id="codeContent">// Ø³ÙŠØ¸Ù‡Ø± Ø§Ù„ÙƒÙˆØ¯ Ù‡Ù†Ø§ Ø¨Ø¹Ø¯ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª</pre>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB: REPORTS â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<div id="tab-reports" class="page">
  <h2 style="font-size:22px;font-weight:900;color:var(--navy);margin-bottom:20px">
    ğŸ“Š Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©
  </h2>

  <!-- Quick Stats Cards -->

  <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;margin-bottom:24px">
    <!-- Today Stats -->
    <div style="background:linear-gradient(135deg,var(--present-lt),#c6f6d5);padding:24px;border-radius:16px;border:2px solid var(--present);box-shadow:var(--shadow-sm)">
      <div style="font-size:13px;color:var(--present);font-weight:700;margin-bottom:12px">ğŸ“… Ø§Ù„ÙŠÙˆÙ…</div>
      <div style="font-size:42px;font-weight:900;color:var(--present);margin-bottom:8px" id="todayAttendanceRate">--%</div>
      <div style="font-size:12px;color:var(--gray-600)">Ù†Ø³Ø¨Ø© Ø§Ù„Ø­Ø¶ÙˆØ±</div>
    </div>

```
<!-- This Week -->
<div style="background:linear-gradient(135deg,var(--blue-xs),var(--blue-lt));padding:24px;border-radius:16px;border:2px solid var(--blue);box-shadow:var(--shadow-sm)">
  <div style="font-size:13px;color:var(--blue);font-weight:700;margin-bottom:12px">ğŸ“† Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</div>
  <div style="font-size:42px;font-weight:900;color:var(--blue);margin-bottom:8px" id="weekAttendanceRate">--%</div>
  <div style="font-size:12px;color:var(--gray-600)">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø­Ø¶ÙˆØ±</div>
</div>

<!-- This Month -->
<div style="background:linear-gradient(135deg,#fef3c7,#fde68a);padding:24px;border-radius:16px;border:2px solid #f59e0b;box-shadow:var(--shadow-sm)">
  <div style="font-size:13px;color:#d97706;font-weight:700;margin-bottom:12px">ğŸ“Š Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</div>
  <div style="font-size:42px;font-weight:900;color:#d97706;margin-bottom:8px" id="monthAttendanceRate">--%</div>
  <div style="font-size:12px;color:var(--gray-600)">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø­Ø¶ÙˆØ±</div>
</div>

<!-- Total Students -->
<div style="background:linear-gradient(135deg,var(--late-lt),#e9d5ff);padding:24px;border-radius:16px;border:2px solid var(--late);box-shadow:var(--shadow-sm)">
  <div style="font-size:13px;color:var(--late);font-weight:700;margin-bottom:12px">ğŸ‘¥ Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div>
  <div style="font-size:42px;font-weight:900;color:var(--late);margin-bottom:8px" id="totalStudentsCount">0</div>
  <div style="font-size:12px;color:var(--gray-600)">Ø·Ø§Ù„Ø¨Ø©</div>
</div>
```

  </div>

  <!-- Charts Row -->

  <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:24px">
    <!-- Pie Chart: Today's Overview -->
    <div style="background:#fff;padding:24px;border-radius:16px;border:1px solid var(--gray-200);box-shadow:var(--shadow-sm)">
      <h3 style="font-size:16px;font-weight:800;color:var(--navy);margin-bottom:16px;display:flex;align-items:center;gap:10px">
        <span style="background:var(--teal-lt);width:32px;height:32px;border-radius:10px;display:inline-flex;align-items:center;justify-content:center;font-size:16px">ğŸ“Š</span>
        Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© - Ø§Ù„ÙŠÙˆÙ…
      </h3>
      <canvas id="todayPieChart" width="300" height="300"></canvas>
    </div>

```
<!-- Bar Chart: Week Trend -->
<div style="background:#fff;padding:24px;border-radius:16px;border:1px solid var(--gray-200);box-shadow:var(--shadow-sm)">
  <h3 style="font-size:16px;font-weight:800;color:var(--navy);margin-bottom:16px;display:flex;align-items:center;gap:10px">
    <span style="background:var(--blue-lt);width:32px;height:32px;border-radius:10px;display:inline-flex;align-items:center;justify-content:center;font-size:16px">ğŸ“ˆ</span>
    Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø­Ø¶ÙˆØ± - Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹
  </h3>
  <canvas id="weekBarChart" width="400" height="300"></canvas>
</div>
```

  </div>

  <!-- Students Table with Notes -->

  <div style="background:#fff;padding:24px;border-radius:16px;border:1px solid var(--gray-200);box-shadow:var(--shadow-sm)">
    <h3 style="font-size:16px;font-weight:800;color:var(--navy);margin-bottom:16px;display:flex;align-items:center;gap:10px">
      <span style="background:var(--present-lt);width:32px;height:32px;border-radius:10px;display:inline-flex;align-items:center;justify-content:center;font-size:16px">ğŸ“</span>
      Ø³Ø¬Ù„ Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª ÙˆØ§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª
    </h3>
    <div id="studentsNotesTable"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB: CERTIFICATES â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<div id="tab-certificates" class="page">
  <h2 style="font-size:22px;font-weight:900;color:var(--navy);margin-bottom:20px">
    ğŸ† Ø´Ù‡Ø§Ø¯Ø§Øª Ø§Ù„Ø´ÙƒØ± ÙˆØ§Ù„ØªÙ‚Ø¯ÙŠØ±
  </h2>

  <!-- Stats -->

  <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-bottom:24px">
    <div style="background:#fff;border-radius:var(--radius);padding:20px;border:1px solid var(--gray-200);text-align:center">
      <div style="font-size:36px;font-weight:900;color:var(--present);margin-bottom:4px" id="perfectAttendanceCount">0</div>
      <div style="font-size:12px;color:var(--gray-600);font-weight:600">Ø·Ø§Ù„Ø¨Ø§Øª Ø¨Ø¯ÙˆÙ† ØºÙŠØ§Ø¨</div>
    </div>
    <div style="background:#fff;border-radius:var(--radius);padding:20px;border:1px solid var(--gray-200);text-align:center">
      <div style="font-size:36px;font-weight:900;color:var(--blue);margin-bottom:4px" id="excellentAttendanceCount">0</div>
      <div style="font-size:12px;color:var(--gray-600);font-weight:600">Ø­Ø¶ÙˆØ± Ù…Ù…ØªØ§Ø² (95%+)</div>
    </div>
    <div style="background:#fff;border-radius:var(--radius);padding:20px;border:1px solid var(--gray-200);text-align:center">
      <div style="font-size:36px;font-weight:900;color:var(--excused);margin-bottom:4px" id="goodAttendanceCount">0</div>
      <div style="font-size:12px;color:var(--gray-600);font-weight:600">Ø­Ø¶ÙˆØ± Ø¬ÙŠØ¯ (90%+)</div>
    </div>
  </div>

  <!-- Certificates Grid -->

  <div style="background:#fff;border-radius:var(--radius);padding:24px;border:1px solid var(--gray-200);box-shadow:var(--shadow-sm);margin-bottom:24px">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px">
      <h3 style="font-size:16px;font-weight:800;color:var(--navy);display:flex;align-items:center;gap:10px">
        <span style="background:var(--present-lt);width:32px;height:32px;border-radius:10px;display:inline-flex;align-items:center;justify-content:center;font-size:16px">ğŸ†</span>
        Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø§Øª Ù„Ø´Ù‡Ø§Ø¯Ø§Øª Ø§Ù„Ø´ÙƒØ±
      </h3>
      <div style="display:flex;gap:8px">
        <button class="btn btn-outline" onclick="printAllCertificates()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙƒÙ„</button>
        <button class="btn btn-primary" onclick="generateCertificates()">ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
      </div>
    </div>
    <div id="certificatesGrid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• QUICK ATTENDANCE MODALS â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<!-- QR Scanner Modal -->

<div id="qrScannerModal" style="display:none;position:fixed;inset:0;background:rgba(10,36,99,.85);backdrop-filter:blur(8px);z-index:9999;overflow-y:auto;padding:20px">
  <div style="max-width:600px;margin:40px auto;background:#fff;border-radius:16px;padding:32px;position:relative">
    <button onclick="closeQRScanner()" style="position:absolute;top:16px;left:16px;background:var(--gray-200);border:none;width:32px;height:32px;border-radius:50%;cursor:pointer;font-size:18px;color:var(--gray-600)">Ã—</button>

```
<div style="text-align:center;margin-bottom:24px">
  <div style="width:80px;height:80px;margin:0 auto 16px;background:linear-gradient(135deg,var(--teal),#0d9488);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:40px;color:#fff">ğŸ“¸</div>
  <h3 style="font-size:20px;font-weight:800;color:var(--navy);margin-bottom:8px">Ù…Ø³Ø­ QR Code</h3>
  <p style="font-size:13px;color:var(--gray-600)">ÙˆØ¬Ù‘Ù‡ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù†Ø­Ùˆ Ø±Ù…Ø² QR Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ø·Ø§Ù„Ø¨Ø©</p>
</div>

<div id="qrReaderDiv" style="background:var(--gray-100);border-radius:12px;height:300px;display:flex;align-items:center;justify-content:center;margin-bottom:20px">
  <div style="text-align:center;color:var(--gray-600)">
    <div style="font-size:48px;margin-bottom:12px">ğŸ“·</div>
    <div style="font-size:14px;font-weight:600">Ù‚Ø±ÙŠØ¨Ø§Ù‹: Ù…Ø§Ø³Ø­ QR Code</div>
    <div style="font-size:12px;margin-top:6px">Ø³ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù„Ù…Ø³Ø­ Ø±Ù…ÙˆØ² Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª</div>
  </div>
</div>

<div style="background:var(--blue-xs);padding:16px;border-radius:12px;border-right:4px solid var(--blue)">
  <div style="font-size:12px;font-weight:700;color:var(--blue);margin-bottom:6px">ğŸ’¡ ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ØŸ</div>
  <div style="font-size:11px;color:var(--gray-600);line-height:1.6">
    ÙƒÙ„ Ø·Ø§Ù„Ø¨Ø© Ù„Ø¯ÙŠÙ‡Ø§ Ø±Ù…Ø² QR ÙØ±ÙŠØ¯ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙ‡Ø§. Ø¨Ù…Ø¬Ø±Ø¯ Ù…Ø³Ø­ Ø§Ù„Ø±Ù…Ø²ØŒ ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ±Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹!
  </div>
</div>
```

  </div>
</div>

<!-- Manual Entry Modal -->

<div id="manualEntryModal" style="display:none;position:fixed;inset:0;background:rgba(10,36,99,.85);backdrop-filter:blur(8px);z-index:9999;overflow-y:auto;padding:20px">
  <div style="max-width:600px;margin:40px auto;background:#fff;border-radius:16px;padding:32px;position:relative">
    <button onclick="closeManualEntry()" style="position:absolute;top:16px;left:16px;background:var(--gray-200);border:none;width:32px;height:32px;border-radius:50%;cursor:pointer;font-size:18px;color:var(--gray-600)">Ã—</button>

```
<div style="text-align:center;margin-bottom:24px">
  <div style="width:80px;height:80px;margin:0 auto 16px;background:linear-gradient(135deg,var(--blue),var(--navy));border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:40px;color:#fff">ğŸ“‹</div>
  <h3 style="font-size:20px;font-weight:800;color:var(--navy);margin-bottom:8px">ØªØ³Ø¬ÙŠÙ„ ÙŠØ¯ÙˆÙŠ</h3>
  <p style="font-size:13px;color:var(--gray-600)">Ø£Ø¯Ø®Ù„ Ø£Ø³Ù…Ø§Ø¡ Ø£Ùˆ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª Ø§Ù„Ø­Ø§Ø¶Ø±Ø§Øª</p>
</div>

<div style="margin-bottom:20px">
  <label style="font-size:13px;font-weight:700;color:var(--navy);display:block;margin-bottom:8px">Ø£Ø¯Ø®Ù„ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø£Ùˆ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… (ÙƒÙ„ Ø§Ø³Ù… ÙÙŠ Ø³Ø·Ø±):</label>
  <textarea id="manualEntryText" placeholder="Ù…Ø«Ø§Ù„:&#10;Ø³Ø§Ø±Ø© Ø§Ù„Ù…Ø§Ù„ÙƒÙŠ&#10;1001&#10;Ù†ÙˆØ±Ø§ Ø§Ù„Ø¹ØªÙŠØ¨ÙŠ&#10;1002" style="width:100%;height:200px;padding:12px;border:2px solid var(--gray-200);border-radius:12px;font-family:'Cairo',sans-serif;font-size:13px;resize:vertical"></textarea>
</div>

<div style="display:flex;gap:12px">
  <button onclick="processManualEntry()" style="flex:1;padding:14px;background:linear-gradient(135deg,var(--blue),var(--navy));color:#fff;border:none;border-radius:12px;font-family:'Cairo',sans-serif;font-size:14px;font-weight:700;cursor:pointer">âœ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ±</button>
  <button onclick="closeManualEntry()" style="flex:1;padding:14px;background:var(--gray-200);color:var(--gray-800);border:none;border-radius:12px;font-family:'Cairo',sans-serif;font-size:14px;font-weight:700;cursor:pointer">Ø¥Ù„ØºØ§Ø¡</button>
</div>
```

  </div>
</div>

<!-- Voice Input Modal -->

<div id="voiceInputModal" style="display:none;position:fixed;inset:0;background:rgba(10,36,99,.85);backdrop-filter:blur(8px);z-index:9999;overflow-y:auto;padding:20px">
  <div style="max-width:600px;margin:40px auto;background:#fff;border-radius:16px;padding:32px;position:relative">
    <button onclick="closeVoiceInput()" style="position:absolute;top:16px;left:16px;background:var(--gray-200);border:none;width:32px;height:32px;border-radius:50%;cursor:pointer;font-size:18px;color:var(--gray-600)">Ã—</button>

```
<div style="text-align:center;margin-bottom:24px">
  <div id="voiceAnimIcon" style="width:80px;height:80px;margin:0 auto 16px;background:linear-gradient(135deg,var(--late),#6d28d9);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:40px;color:#fff">ğŸ¤</div>
  <h3 style="font-size:20px;font-weight:800;color:var(--navy);margin-bottom:8px">ØªØ³Ø¬ÙŠÙ„ ØµÙˆØªÙŠ</h3>
  <p style="font-size:13px;color:var(--gray-600)">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ† ÙˆØ§Ø¨Ø¯Ø£ Ø§Ù„Ø¥Ù…Ù„Ø§Ø¡</p>
</div>

<div style="text-align:center;margin-bottom:24px">
  <button id="voiceStartBtn" onclick="startVoiceRecording()" style="width:120px;height:120px;background:linear-gradient(135deg,var(--late),#6d28d9);border:none;border-radius:50%;cursor:pointer;font-size:48px;color:#fff;transition:all .3s;box-shadow:0 8px 24px rgba(124,58,237,.3)" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'">ğŸ¤</button>
  <div id="voiceStatus" style="font-size:14px;font-weight:700;color:var(--navy);margin-top:16px">Ø§Ø¶ØºØ· Ù„Ù„Ø¨Ø¯Ø¡</div>
</div>

<div id="voiceTranscript" style="background:var(--gray-50);padding:16px;border-radius:12px;min-height:100px;font-size:13px;color:var(--gray-800);margin-bottom:20px;display:none">
  <div style="font-size:11px;font-weight:700;color:var(--gray-600);margin-bottom:8px">Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø³Ø¬Ù„:</div>
  <div id="voiceTranscriptText"></div>
</div>

<div style="background:var(--late-lt);padding:16px;border-radius:12px;border-right:4px solid var(--late)">
  <div style="font-size:12px;font-weight:700;color:var(--late);margin-bottom:6px">ğŸ’¡ Ø£Ù…Ø«Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ù…Ù„Ø§Ø¡:</div>
  <div style="font-size:11px;color:var(--gray-600);line-height:1.6">
    "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª Ø­Ø§Ø¶Ø±Ø§Øª Ø¹Ø¯Ø§ Ø³Ø§Ø±Ø© ÙˆÙ†ÙˆØ±Ø§"<br>
    "ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ± Ø§Ù„Ø¬Ù…ÙŠØ¹"<br>
    "Ø³Ø§Ø±Ø© ØºØ§Ø¦Ø¨Ø©ØŒ Ù†ÙˆØ±Ø§ Ù…ØªØ£Ø®Ø±Ø©"
  </div>
</div>
```

  </div>
</div>

<!-- Quick List Modal -->

<div id="quickListModal" style="display:none;position:fixed;inset:0;background:rgba(10,36,99,.85);backdrop-filter:blur(8px);z-index:9999;overflow-y:auto;padding:20px">
  <div style="max-width:800px;margin:40px auto;background:#fff;border-radius:16px;padding:32px;position:relative">
    <button onclick="closeQuickList()" style="position:absolute;top:16px;left:16px;background:var(--gray-200);border:none;width:32px;height:32px;border-radius:50%;cursor:pointer;font-size:18px;color:var(--gray-600)">Ã—</button>

```
<div style="text-align:center;margin-bottom:24px">
  <div style="width:80px;height:80px;margin:0 auto 16px;background:linear-gradient(135deg,var(--present),#15803d);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:40px;color:#fff">â˜‘ï¸</div>
  <h3 style="font-size:20px;font-weight:800;color:var(--navy);margin-bottom:8px">Ù‚Ø§Ø¦Ù…Ø© Ø³Ø±ÙŠØ¹Ø©</h3>
  <p style="font-size:13px;color:var(--gray-600)">Ø­Ø¯Ø¯ Ø­Ø§Ù„Ø© ÙƒÙ„ Ø·Ø§Ù„Ø¨Ø© Ø¨Ù†Ù‚Ø±Ø© ÙˆØ§Ø­Ø¯Ø©</p>
</div>

<!-- Date Picker -->
<div style="background:var(--blue-xs);padding:16px;border-radius:12px;border:2px solid var(--blue);margin-bottom:20px">
  <label style="font-size:13px;font-weight:700;color:var(--navy);display:block;margin-bottom:8px">ğŸ“… Ø§Ø®ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ®:</label>
  <select id="quickListDateSelect" onchange="updateQuickListDate()" style="width:100%;padding:12px;border:2px solid var(--blue);border-radius:8px;font-family:'Cairo',sans-serif;font-size:13px;font-weight:600;background:#fff;color:var(--navy)">
  </select>
  <div style="font-size:11px;color:var(--gray-600);margin-top:6px">ğŸ’¡ Ø³ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ù„Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø­Ø¯Ø¯</div>
</div>

<div style="display:flex;gap:12px;margin-bottom:20px;padding:12px;background:var(--gray-50);border-radius:12px">
  <button onclick="quickSelectAll('P')" style="flex:1;padding:10px;background:var(--present-lt);color:var(--present);border:2px solid var(--present);border-radius:8px;font-family:'Cairo',sans-serif;font-size:12px;font-weight:700;cursor:pointer">âœ… Ø§Ù„ÙƒÙ„ Ø­Ø§Ø¶Ø±</button>
  <button onclick="quickSelectAll('A')" style="flex:1;padding:10px;background:var(--absent-lt);color:var(--absent);border:2px solid var(--absent);border-radius:8px;font-family:'Cairo',sans-serif;font-size:12px;font-weight:700;cursor:pointer">âŒ Ø§Ù„ÙƒÙ„ ØºØ§Ø¦Ø¨</button>
  <button onclick="quickClearAll()" style="flex:1;padding:10px;background:var(--gray-100);color:var(--gray-600);border:2px solid var(--gray-400);border-radius:8px;font-family:'Cairo',sans-serif;font-size:12px;font-weight:700;cursor:pointer">ğŸ”„ Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
</div>

<div id="quickListStudents" style="max-height:400px;overflow-y:auto;margin-bottom:20px"></div>

<div style="display:flex;gap:12px">
  <button onclick="saveQuickList()" style="flex:1;padding:14px;background:linear-gradient(135deg,var(--present),#15803d);color:#fff;border:none;border-radius:12px;font-family:'Cairo',sans-serif;font-size:14px;font-weight:700;cursor:pointer">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø­Ø¶ÙˆØ±</button>
  <button onclick="closeQuickList()" style="padding:14px 24px;background:var(--gray-200);color:var(--gray-800);border:none;border-radius:12px;font-family:'Cairo',sans-serif;font-size:14px;font-weight:700;cursor:pointer">Ø¥Ù„ØºØ§Ø¡</button>
</div>
```

  </div>
</div>

<!-- Student Notes Modal -->

<div id="studentNotesModal" style="display:none;position:fixed;inset:0;background:rgba(10,36,99,.85);backdrop-filter:blur(8px);z-index:9999;overflow-y:auto;padding:20px">
  <div style="max-width:700px;margin:40px auto;background:#fff;border-radius:16px;padding:32px;position:relative">
    <button onclick="closeStudentNotes()" style="position:absolute;top:16px;left:16px;background:var(--gray-200);border:none;width:32px;height:32px;border-radius:50%;cursor:pointer;font-size:18px;color:var(--gray-600)">Ã—</button>

```
<div style="display:flex;align-items:center;gap:16px;margin-bottom:24px">
  <div id="noteStudentAvatar" style="width:64px;height:64px;border-radius:50%;background:var(--blue);display:flex;align-items:center;justify-content:center;font-size:24px;font-weight:800;color:#fff"></div>
  <div style="flex:1">
    <h3 id="noteStudentName" style="font-size:20px;font-weight:800;color:var(--navy);margin-bottom:4px"></h3>
    <div id="noteStudentId" style="font-size:12px;color:var(--gray-600)"></div>
  </div>
  <div id="noteStudentStatus" style="padding:8px 16px;border-radius:8px;font-size:12px;font-weight:700"></div>
</div>

<!-- Add New Note -->
<div style="background:var(--blue-xs);padding:20px;border-radius:12px;margin-bottom:20px;border:2px solid var(--blue)">
  <div style="font-size:14px;font-weight:700;color:var(--navy);margin-bottom:12px">ğŸ’¬ Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø§Ø­Ø¸Ø© Ø¬Ø¯ÙŠØ¯Ø©</div>
  <textarea id="newNoteText" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸ØªÙƒ Ù‡Ù†Ø§..." style="width:100%;height:80px;padding:12px;border:2px solid var(--gray-200);border-radius:8px;font-family:'Cairo',sans-serif;font-size:13px;resize:vertical;margin-bottom:12px"></textarea>
  <div style="display:flex;gap:8px">
    <select id="noteType" style="flex:1;padding:10px;border:2px solid var(--gray-200);border-radius:8px;font-family:'Cairo',sans-serif;font-size:13px">
      <option value="positive">ğŸŒŸ Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ©</option>
      <option value="neutral">ğŸ“ Ø¹Ø§Ø¯ÙŠØ©</option>
      <option value="warning">âš ï¸ ØªØ­Ø°ÙŠØ±</option>
    </select>
    <button onclick="addStudentNote()" style="padding:10px 24px;background:var(--blue);color:#fff;border:none;border-radius:8px;font-family:'Cairo',sans-serif;font-size:13px;font-weight:700;cursor:pointer">â• Ø¥Ø¶Ø§ÙØ©</button>
  </div>
</div>

<!-- Previous Notes -->
<div>
  <div style="font-size:14px;font-weight:700;color:var(--navy);margin-bottom:12px">ğŸ“‹ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</div>
  <div id="previousNotesList" style="max-height:300px;overflow-y:auto"></div>
</div>
```

  </div>
</div>

<!-- Certificate Print Modal -->

<div id="certificateModal" style="display:none;position:fixed;inset:0;background:rgba(10,36,99,.85);backdrop-filter:blur(8px);z-index:9999;overflow-y:auto;padding:20px">
  <div style="max-width:210mm;margin:0 auto;position:relative">
    <div style="position:sticky;top:20px;background:#fff;padding:12px;border-radius:12px;margin-bottom:20px;display:flex;gap:10px;justify-content:flex-end;z-index:10;box-shadow:var(--shadow-md)">
      <button class="btn btn-outline" onclick="closeCertificate()">âœ– Ø¥ØºÙ„Ø§Ù‚</button>
      <button class="btn btn-primary" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
    </div>
    <div id="certificateContent" style="background:#fff;border-radius:16px;overflow:hidden;box-shadow:var(--shadow-lg)"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB: LETTERS â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<div id="tab-letters" class="page">
  <h2 style="font-size:22px;font-weight:900;color:var(--navy);margin-bottom:20px">
    âœ‰ï¸ Ø®Ø·Ø§Ø¨Ø§Øª Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±
  </h2>
  <div style="background:#fff;padding:40px;border-radius:16px;border:1px solid var(--gray-200);text-align:center">
    <div style="font-size:48px;margin-bottom:16px">âœ‰ï¸</div>
    <div style="font-size:18px;font-weight:700;color:var(--navy);margin-bottom:8px">
      Ø®Ø·Ø§Ø¨Ø§Øª Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±
    </div>
    <div style="font-size:13px;color:var(--gray-600)">
      Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®Ø·Ø§Ø¨Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù„Ù„Ø·Ø§Ù„Ø¨Ø§Øª Ø§Ù„Ù„ÙŠ Ø¹Ù†Ø¯Ù‡Ù† 3 Ø£ÙŠØ§Ù… ØºÙŠØ§Ø¨ Ø¨Ø¯ÙˆÙ† Ø¹Ø°Ø±
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB: PARENTS â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<div id="tab-parents" class="page">
  <h2 style="font-size:22px;font-weight:900;color:var(--navy);margin-bottom:20px">
    ğŸ“± Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ±
  </h2>

  <!-- Info Box -->

  <div style="background:var(--blue-xs);padding:16px;border-radius:12px;border-right:4px solid var(--blue);margin-bottom:24px">
    <div style="font-size:13px;color:var(--navy);line-height:1.6">
      ğŸ’¡ <strong>ØªÙ†Ø¨ÙŠÙ‡:</strong> ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ± Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ø£Ùˆ Ø±Ø³Ø§Ø¦Ù„ Ù†ØµÙŠØ© Ù„Ø¥Ø¨Ù„Ø§ØºÙ‡Ù… Ø¨Ø­Ø¶ÙˆØ±/ØºÙŠØ§Ø¨ Ø¨Ù†Ø§ØªÙ‡Ù….
    </div>
  </div>

  <!-- Parents List -->

  <div id="parentsListContainer"></div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• TAB: ADMIN â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<div id="tab-admin" class="page">
  <h2 style="font-size:22px;font-weight:900;color:var(--navy);margin-bottom:20px">
    ğŸ‘¥ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø´Ø±ÙØ©
  </h2>

  <!-- KPIs -->

  <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:24px">
    <div style="background:#fff;border-radius:var(--radius);padding:20px;border:1px solid var(--gray-200);text-align:center">
      <div style="font-size:36px;font-weight:900;color:var(--blue);margin-bottom:4px">8</div>
      <div style="font-size:12px;color:var(--gray-600);font-weight:600">Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„ÙØ±ÙŠÙ‚</div>
    </div>
    <div style="background:#fff;border-radius:var(--radius);padding:20px;border:1px solid var(--gray-200);text-align:center">
      <div style="font-size:36px;font-weight:900;color:var(--present);margin-bottom:4px" id="onlineCount">-</div>
      <div style="font-size:12px;color:var(--gray-600);font-weight:600">Ù…ØªØµÙ„ Ø§Ù„Ø¢Ù†</div>
    </div>
    <div style="background:#fff;border-radius:var(--radius);padding:20px;border:1px solid var(--gray-200);text-align:center">
      <div style="font-size:36px;font-weight:900;color:var(--excused);margin-bottom:4px">0</div>
      <div style="font-size:12px;color:var(--gray-600);font-weight:600">Ø¥Ø¯Ø®Ø§Ù„Ø§Øª Ø§Ù„ÙŠÙˆÙ…</div>
    </div>
    <div style="background:#fff;border-radius:var(--radius);padding:20px;border:1px solid var(--gray-200);text-align:center">
      <div style="font-size:36px;font-weight:900;color:var(--late);margin-bottom:4px">0</div>
      <div style="font-size:12px;color:var(--gray-600);font-weight:600">Ø®Ø·Ø§Ø¨Ø§Øª Ù…Ø¹Ù„Ù‚Ø©</div>
    </div>
  </div>

  <!-- Data Management & Backup -->

  <div style="background:#fff;border-radius:var(--radius);padding:24px;border:1px solid var(--gray-200);box-shadow:var(--shadow-sm);margin-bottom:24px">
    <h3 style="font-size:16px;font-weight:800;color:var(--navy);margin-bottom:20px;display:flex;align-items:center;gap:10px">
      <span style="background:var(--teal-lt);width:32px;height:32px;border-radius:10px;display:inline-flex;align-items:center;justify-content:center;font-size:16px">ğŸ’¾</span>
      Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
    </h3>

```
<div style="background:var(--blue-xs);padding:20px;border-radius:12px;border-right:4px solid var(--blue);margin-bottom:20px">
  <div style="font-size:13px;font-weight:700;color:var(--blue);margin-bottom:8px">â„¹ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…Ù‡Ù…Ø©</div>
  <div style="font-size:12px;color:var(--gray-600);line-height:1.6">
    â€¢ ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©<br>
    â€¢ Ø¬Ù…ÙŠØ¹ Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„ÙØ±ÙŠÙ‚ ÙŠØ´Ø§Ù‡Ø¯ÙˆÙ† Ù†ÙØ³ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ù…ÙˆÙ‚Ø¹<br>
    â€¢ ÙŠÙÙ†ØµØ­ Ø¨Ø¹Ù…Ù„ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ÙŠÙˆÙ…ÙŠØ§Ù‹<br>
    â€¢ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø© ÙÙŠ Ù…ØªØµÙØ­ Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±
  </div>
</div>

<div style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px">
  <!-- Save Now -->
  <button onclick="DataPersistence.saveAll(); NotificationSystem.show('âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­', 'success')" style="padding:16px;background:linear-gradient(135deg,var(--present),#15803d);color:#fff;border:none;border-radius:12px;font-family:'Cairo',sans-serif;font-size:14px;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;transition:all .2s" onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='var(--shadow-md)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
    <span style="font-size:20px">ğŸ’¾</span>
    <span>Ø­ÙØ¸ Ø§Ù„Ø¢Ù†</span>
  </button>
  
  <!-- Export Backup -->
  <button onclick="DataPersistence.exportToFile()" style="padding:16px;background:linear-gradient(135deg,var(--blue),var(--navy));color:#fff;border:none;border-radius:12px;font-family:'Cairo',sans-serif;font-size:14px;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;transition:all .2s" onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='var(--shadow-md)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
    <span style="font-size:20px">ğŸ“¥</span>
    <span>ØªØµØ¯ÙŠØ± Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</span>
  </button>
  
  <!-- Import Backup -->
  <button onclick="document.getElementById('importFileInput').click()" style="padding:16px;background:linear-gradient(135deg,var(--excused),#ea580c);color:#fff;border:none;border-radius:12px;font-family:'Cairo',sans-serif;font-size:14px;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;transition:all .2s" onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='var(--shadow-md)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
    <span style="font-size:20px">ğŸ“¤</span>
    <span>Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</span>
  </button>
  <input type="file" id="importFileInput" accept=".json" style="display:none" onchange="DataPersistence.importFromFile(this); this.value=''">
  
  <!-- Clear Data -->
  <button onclick="DataPersistence.clearAll()" style="padding:16px;background:linear-gradient(135deg,var(--absent),#b91c1c);color:#fff;border:none;border-radius:12px;font-family:'Cairo',sans-serif;font-size:14px;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;transition:all .2s" onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='var(--shadow-md)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
    <span style="font-size:20px">ğŸ—‘ï¸</span>
    <span>Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span>
  </button>
</div>

<div id="lastSaveTime" style="margin-top:16px;text-align:center;font-size:11px;color:var(--gray-600)"></div>
```

  </div>

  <!-- Team Members Management -->

  <div style="background:#fff;border-radius:var(--radius);padding:24px;border:1px solid var(--gray-200);box-shadow:var(--shadow-sm);margin-bottom:24px">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px">
      <h3 style="font-size:16px;font-weight:800;color:var(--navy);display:flex;align-items:center;gap:10px;margin:0">
        <span style="background:var(--blue-lt);width:32px;height:32px;border-radius:10px;display:inline-flex;align-items:center;justify-content:center;font-size:16px">ğŸ‘¥</span>
        Ø¥Ø¯Ø§Ø±Ø© Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„ÙØ±ÙŠÙ‚
      </h3>
      <button onclick="openAddMemberModal()" style="padding:10px 20px;background:linear-gradient(135deg,var(--blue),var(--navy));color:#fff;border:none;border-radius:8px;font-family:'Cairo',sans-serif;font-size:13px;font-weight:700;cursor:pointer;display:flex;align-items:center;gap:8px">
        <span>â•</span>
        <span>Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯</span>
      </button>
    </div>
    <div id="teamMembersList" style="display:grid;gap:12px"></div>
  </div>

  <!-- Access Log -->

  <div style="background:#fff;border-radius:var(--radius);padding:24px;border:1px solid var(--gray-200);box-shadow:var(--shadow-sm)">
    <h3 style="font-size:16px;font-weight:800;color:var(--navy);margin-bottom:20px;display:flex;align-items:center;gap:10px">
      <span style="background:var(--present-lt);width:32px;height:32px;border-radius:10px;display:inline-flex;align-items:center;justify-content:center;font-size:16px">ğŸ“Š</span>
      Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„Ù†Ø´Ø§Ø·Ø§Øª
    </h3>
    <div style="max-height:300px;overflow-y:auto">
      <div style="text-align:center;padding:40px;color:var(--gray-400)">
        <div style="font-size:48px;margin-bottom:12px">ğŸ“‹</div>
        <div style="font-size:14px;font-weight:600">Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª Ù‡Ù†Ø§</div>
        <div style="font-size:12px;margin-top:6px">Ø¬Ù…ÙŠØ¹ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© ÙˆØ§Ù„ØªØ¹Ø¯ÙŠÙ„ ÙˆØ§Ù„Ø­Ø°Ù</div>
      </div>
    </div>
  </div>
</div>

<!-- Add/Edit Member Modal -->

<div id="memberModal" style="display:none;position:fixed;inset:0;background:rgba(10,36,99,.85);backdrop-filter:blur(8px);z-index:9999;overflow-y:auto;padding:20px">
  <div style="max-width:500px;margin:40px auto;background:#fff;border-radius:16px;padding:32px;position:relative">
    <button onclick="closeMemberModal()" style="position:absolute;top:16px;left:16px;background:var(--gray-200);border:none;width:32px;height:32px;border-radius:50%;cursor:pointer;font-size:18px;color:var(--gray-600)">Ã—</button>

```
<div style="text-align:center;margin-bottom:24px">
  <div style="width:80px;height:80px;margin:0 auto 16px;background:linear-gradient(135deg,var(--blue),var(--navy));border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:40px;color:#fff">ğŸ‘¤</div>
  <h3 id="memberModalTitle" style="font-size:20px;font-weight:800;color:var(--navy);margin-bottom:8px">Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯</h3>
  <p style="font-size:13px;color:var(--gray-600)">Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø¶Ùˆ Ø§Ù„ÙØ±ÙŠÙ‚</p>
</div>

<div style="display:grid;gap:16px;margin-bottom:24px">
  <div>
    <label style="font-size:13px;font-weight:700;color:var(--navy);display:block;margin-bottom:8px">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„:</label>
    <input id="memberName" type="text" placeholder="Ù…Ø«Ø§Ù„: Ø³Ø§Ø±Ø© Ø£Ø­Ù…Ø¯ Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ" style="width:100%;padding:12px;border:2px solid var(--gray-200);border-radius:8px;font-family:'Cairo',sans-serif;font-size:13px">
  </div>
  
  <div>
    <label style="font-size:13px;font-weight:700;color:var(--navy);display:block;margin-bottom:8px">Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ:</label>
    <select id="memberRole" style="width:100%;padding:12px;border:2px solid var(--gray-200);border-radius:8px;font-family:'Cairo',sans-serif;font-size:13px">
      <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ</option>
      <option value="Ù…Ø¯ÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©">Ù…Ø¯ÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</option>
      <option value="ÙˆÙƒÙŠÙ„Ø© Ø´Ø¤ÙˆÙ† Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª">ÙˆÙƒÙŠÙ„Ø© Ø´Ø¤ÙˆÙ† Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª</option>
      <option value="Ù…Ø¹Ù„Ù…Ø©">Ù…Ø¹Ù„Ù…Ø©</option>
      <option value="Ù…Ø¹Ù„Ù…Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©">Ù…Ø¹Ù„Ù…Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</option>
      <option value="Ù…Ø¹Ù„Ù…Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©">Ù…Ø¹Ù„Ù…Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
      <option value="Ù…Ø¹Ù„Ù…Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª">Ù…Ø¹Ù„Ù…Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª</option>
      <option value="Ù…Ø¹Ù„Ù…Ø© Ø§Ù„Ø¹Ù„ÙˆÙ…">Ù…Ø¹Ù„Ù…Ø© Ø§Ù„Ø¹Ù„ÙˆÙ…</option>
      <option value="Ù…Ø±Ø´Ø¯Ø© Ø·Ù„Ø§Ø¨ÙŠØ©">Ù…Ø±Ø´Ø¯Ø© Ø·Ù„Ø§Ø¨ÙŠØ©</option>
      <option value="Ù…ÙˆØ¬Ù‡Ø© Ø·Ù„Ø§Ø¨ÙŠØ©">Ù…ÙˆØ¬Ù‡Ø© Ø·Ù„Ø§Ø¨ÙŠØ©</option>
      <option value="Ø¥Ø¯Ø§Ø±ÙŠØ©">Ø¥Ø¯Ø§Ø±ÙŠØ©</option>
    </select>
  </div>
  
  <div>
    <label style="font-size:13px;font-weight:700;color:var(--navy);display:block;margin-bottom:8px">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ (4 Ø£Ø±Ù‚Ø§Ù…):</label>
    <input id="memberPassword" type="text" placeholder="Ù…Ø«Ø§Ù„: 1234" maxlength="4" style="width:100%;padding:12px;border:2px solid var(--gray-200);border-radius:8px;font-family:'Cairo',sans-serif;font-size:13px">
  </div>
</div>

<div style="background:var(--blue-xs);padding:16px;border-radius:8px;border-right:4px solid var(--blue);margin-bottom:20px">
  <div style="font-size:11px;color:var(--gray-600);line-height:1.6">
    ğŸ’¡ <strong>ØªÙ†Ø¨ÙŠÙ‡:</strong> Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 4 Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø·. ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø±Ù‡ Ù…Ø¹ Ø£Ø¹Ø¶Ø§Ø¡ Ø¢Ø®Ø±ÙŠÙ†.
  </div>
</div>

<div style="display:flex;gap:12px">
  <button id="saveMemberBtn" onclick="saveMember()" style="flex:1;padding:14px;background:linear-gradient(135deg,var(--blue),var(--navy));color:#fff;border:none;border-radius:12px;font-family:'Cairo',sans-serif;font-size:14px;font-weight:700;cursor:pointer">ğŸ’¾ Ø­ÙØ¸</button>
  <button onclick="closeMemberModal()" style="flex:1;padding:14px;background:var(--gray-200);color:var(--gray-800);border:none;border-radius:12px;font-family:'Cairo',sans-serif;font-size:14px;font-weight:700;cursor:pointer">Ø¥Ù„ØºØ§Ø¡</button>
</div>
```

  </div>
</div>

<!-- â•â• FOOTER â•â• -->

<div style="background:#fff;border-top:2px solid var(--gray-200);padding:24px 32px;margin-top:40px">
  <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:20px">

```
<!-- Principal -->
<div style="text-align:center;padding:16px;background:var(--gray-50);border-radius:12px">
  <div style="width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,#ec4899,#db2777);display:flex;align-items:center;justify-content:center;color:#fff;font-size:24px;font-weight:800;margin:0 auto 12px">Ù‡</div>
  <div style="font-size:13px;font-weight:700;color:var(--navy);margin-bottom:4px">Ù…Ø¯ÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</div>
  <div style="font-size:14px;font-weight:800;color:var(--gray-800)">Ø£. Ù‡Ø¨Ù‡ ØµÙ…</div>
</div>

<!-- Supervisor -->
<div style="text-align:center;padding:16px;background:var(--gray-50);border-radius:12px">
  <div style="width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,#8b5cf6,#7c3aed);display:flex;align-items:center;justify-content:center;color:#fff;font-size:24px;font-weight:800;margin:0 auto 12px">Ø¹</div>
  <div style="font-size:13px;font-weight:700;color:var(--navy);margin-bottom:4px">ÙˆÙƒÙŠÙ„Ø© Ø´Ø¤ÙˆÙ† Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª</div>
  <div style="font-size:14px;font-weight:800;color:var(--gray-800)">Ø£. Ø¹ÙŠØ´Ø© Ø¹ÙˆØ§Ø¬ÙŠ</div>
</div>

<!-- Designer -->
<div style="text-align:center;padding:16px;background:var(--gray-50);border-radius:12px">
  <div style="width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,var(--blue),var(--navy));display:flex;align-items:center;justify-content:center;color:#fff;font-size:24px;font-weight:800;margin:0 auto 12px">Ù†</div>
  <div style="font-size:13px;font-weight:700;color:var(--navy);margin-bottom:4px">Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØªØµÙ…ÙŠÙ…</div>
  <div style="font-size:14px;font-weight:800;color:var(--gray-800);margin-bottom:2px">Ø£. Ù†Ø¹Ù…Ù‡ ÙØ§Ø¦Ø¹ Ø¹Ø³ÙŠØ±ÙŠ</div>
  <div style="font-size:11px;color:var(--gray-600)">Ù…Ø¹Ù„Ù…Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</div>
</div>
```

  </div>

  <!-- Copyright Notice -->

  <div style="text-align:center;margin-top:24px;padding-top:20px;border-top:1px solid var(--gray-200)">
    <div style="font-size:13px;font-weight:700;color:var(--navy);margin-bottom:6px;display:flex;align-items:center;justify-content:center;gap:8px">
      <span style="font-size:16px">Â©ï¸</span>
      <span>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© 2026</span>
    </div>
    <div style="font-size:12px;color:var(--gray-600);margin-bottom:4px">
      ØªØµÙ…ÙŠÙ… ÙˆØ¨Ø±Ù…Ø¬Ø©: <strong style="color:var(--blue)">Ø£. Ù†Ø¹Ù…Ù‡ ÙØ§Ø¦Ø¹ Ø¹Ø³ÙŠØ±ÙŠ</strong>
    </div>
    <div style="font-size:11px;color:var(--gray-500)">
      Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¨Ø¬Ø§Ø²Ø§Ù† â€¢ Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
    </div>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  AUTHENTICATION & ACCESS CONTROL SYSTEM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// Team members system - Dynamic and editable
let ADMIN_PASSWORDS = {
  // Ù…Ø¯ÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©
  '0000': {name: 'Ù‡Ø¨Ù‡ ØµÙ…', role: 'Ù…Ø¯ÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©'},
  
  // ÙˆÙƒÙŠÙ„Ø© Ø´Ø¤ÙˆÙ† Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª
  '1448': {name: 'Ø¹ÙŠØ´Ø© Ø¹ÙˆØ§Ø¬ÙŠ', role: 'ÙˆÙƒÙŠÙ„Ø© Ø´Ø¤ÙˆÙ† Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª'},
  
  // Ù…Ø¹Ù„Ù…Ø©
  '2024': {name: 'Ù†Ø¹Ù…Ù‡ ÙØ§Ø¦Ø¹ Ø¹Ø³ÙŠØ±ÙŠ', role: 'Ù…Ø¹Ù„Ù…Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©'},
  
  // Ù…ÙˆØ¬Ù‡Ø§Øª Ø·Ù„Ø§Ø¨ÙŠØ©
  '5555': {name: 'ÙØ§Ø·Ù…Ø© Ø§Ù„Ø­Ø±Ø¨ÙŠ', role: 'Ù…ÙˆØ¬Ù‡Ø© Ø·Ù„Ø§Ø¨ÙŠØ©'},
  '6666': {name: 'ÙØ§Ø·Ù…Ø© Ø¬Ø§Ø¨Ø±', role: 'Ù…ÙˆØ¬Ù‡Ø© Ø·Ù„Ø§Ø¨ÙŠØ©'},
  
  // Ø¥Ø¯Ø§Ø±ÙŠØ§Øª
  '7777': {name: 'Ù‡Ø§Ø¬Ø± ØµÙ…ÙŠÙ„ÙŠ', role: 'Ø¥Ø¯Ø§Ø±ÙŠØ©'},
  '8888': {name: 'Ù†ÙˆØ±Ø§ ÙÙ‚ÙŠÙ‡', role: 'Ø¥Ø¯Ø§Ø±ÙŠØ©'},
  '9999': {name: 'Ù„ÙŠÙ„Ù‰ Ù†Ø§Ù…Ø³ÙŠ', role: 'Ø¥Ø¯Ø§Ø±ÙŠØ©'}
};

// Load team members from localStorage
function loadTeamMembers() {
  try {
    const stored = localStorage.getItem('team_members');
    if (stored) {
      ADMIN_PASSWORDS = JSON.parse(stored);
      console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„ÙØ±ÙŠÙ‚');
    }
  } catch (e) {
    console.error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙØ±ÙŠÙ‚:', e);
  }
}

// Save team members to localStorage
function saveTeamMembers() {
  try {
    localStorage.setItem('team_members', JSON.stringify(ADMIN_PASSWORDS));
    console.log('âœ… ØªÙ… Ø­ÙØ¸ Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„ÙØ±ÙŠÙ‚');
  } catch (e) {
    console.error('ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„ÙØ±ÙŠÙ‚:', e);
  }
}

// Load on startup
loadTeamMembers();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  FIREBASE REAL-TIME CLOUD SYNC SYSTEM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// Firebase Configuration - PRODUCTION
const firebaseConfig = {
  apiKey: "AIzaSyCpVS1_MKDhVD3_fWhOpzSYjH14K14UUxw",
  authDomain: "electronic-attendance-2026.firebaseapp.com",
  projectId: "electronic-attendance-2026",
  storageBucket: "electronic-attendance-2026.firebasestorage.app",
  messagingSenderId: "274641429722",
  appId: "1:274641429722:web:46e3c50376e6070973f1e3"
};

let db = null;
let isFirebaseEnabled = false;

// Initialize Firebase
try {
  firebase.initializeApp(firebaseConfig);
  db = firebase.firestore();
  isFirebaseEnabled = true;
  console.log('ğŸ”¥ Firebase connected - Cloud sync enabled!');
} catch (error) {
  console.warn('âš ï¸ Firebase not available - Using local storage only', error);
  isFirebaseEnabled = false;
}

// Cloud Data Management
const CloudSync = {
  // Load all data from cloud
  async loadFromCloud() {
    if (!isFirebaseEnabled) return false;
    
    try {
      console.log('â˜ï¸ Loading data from cloud...');
      
      // Load students
      const studentsDoc = await db.collection('attendance-system').doc('students').get();
      if (studentsDoc.exists) {
        const data = studentsDoc.data();
        STUDENTS.length = 0;
        STUDENTS.push(...(data.list || []));
        console.log(`âœ… Loaded ${STUDENTS.length} students from cloud`);
      }
      
      // Load attendance
      const attendanceDoc = await db.collection('attendance-system').doc('attendance').get();
      if (attendanceDoc.exists) {
        const data = attendanceDoc.data();
        Object.keys(attendanceData).forEach(key => delete attendanceData[key]);
        Object.assign(attendanceData, data.records || {});
        console.log(`âœ… Loaded attendance records from cloud`);
      }
      
      // Load notes
      const notesDoc = await db.collection('attendance-system').doc('notes').get();
      if (notesDoc.exists) {
        const data = notesDoc.data();
        Object.keys(studentNotes).forEach(key => delete studentNotes[key]);
        Object.assign(studentNotes, data.records || {});
        console.log(`âœ… Loaded notes from cloud`);
      }
      
      // Load team members
      const teamDoc = await db.collection('attendance-system').doc('team').get();
      if (teamDoc.exists) {
        const data = teamDoc.data();
        Object.keys(ADMIN_PASSWORDS).forEach(key => delete ADMIN_PASSWORDS[key]);
        Object.assign(ADMIN_PASSWORDS, data.members || {});
        console.log(`âœ… Loaded team members from cloud`);
      }
      
      return true;
    } catch (error) {
      console.error('âŒ Error loading from cloud:', error);
      return false;
    }
  },
  
  // Save students to cloud
  async saveStudents() {
    if (!isFirebaseEnabled) return;
    
    try {
      await db.collection('attendance-system').doc('students').set({
        list: STUDENTS,
        lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
      });
      console.log('â˜ï¸ Students saved to cloud');
    } catch (error) {
      console.error('Error saving students:', error);
    }
  },
  
  // Save attendance to cloud
  async saveAttendance() {
    if (!isFirebaseEnabled) return;
    
    try {
      await db.collection('attendance-system').doc('attendance').set({
        records: attendanceData,
        lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
      });
      console.log('â˜ï¸ Attendance saved to cloud');
    } catch (error) {
      console.error('Error saving attendance:', error);
    }
  },
  
  // Save notes to cloud
  async saveNotes() {
    if (!isFirebaseEnabled) return;
    
    try {
      await db.collection('attendance-system').doc('notes').set({
        records: studentNotes,
        lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
      });
      console.log('â˜ï¸ Notes saved to cloud');
    } catch (error) {
      console.error('Error saving notes:', error);
    }
  },
  
  // Save team members to cloud
  async saveTeam() {
    if (!isFirebaseEnabled) return;
    
    try {
      await db.collection('attendance-system').doc('team').set({
        members: ADMIN_PASSWORDS,
        lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
      });
      console.log('â˜ï¸ Team saved to cloud');
    } catch (error) {
      console.error('Error saving team:', error);
    }
  },
  
  // Save all data to cloud
  async saveAll() {
    if (!isFirebaseEnabled) return;
    
    try {
      await Promise.all([
        this.saveStudents(),
        this.saveAttendance(),
        this.saveNotes(),
        this.saveTeam()
      ]);
      console.log('âœ… All data synced to cloud');
    } catch (error) {
      console.error('Error saving to cloud:', error);
    }
  },
  
  // Enable real-time listeners
  enableRealtimeSync() {
    if (!isFirebaseEnabled) return;
    
    // Listen for students changes
    db.collection('attendance-system').doc('students').onSnapshot((doc) => {
      if (doc.exists && !doc.metadata.hasPendingWrites) {
        const data = doc.data();
        STUDENTS.length = 0;
        STUDENTS.push(...(data.list || []));
        if (typeof renderStudentList === 'function') renderStudentList();
        if (typeof updateAttendanceTable === 'function') updateAttendanceTable();
        console.log('ğŸ”„ Students synced from cloud');
      }
    });
    
    // Listen for attendance changes
    db.collection('attendance-system').doc('attendance').onSnapshot((doc) => {
      if (doc.exists && !doc.metadata.hasPendingWrites) {
        const data = doc.data();
        Object.keys(attendanceData).forEach(key => delete attendanceData[key]);
        Object.assign(attendanceData, data.records || {});
        if (typeof updateAttendanceTable === 'function') updateAttendanceTable();
        console.log('ğŸ”„ Attendance synced from cloud');
      }
    });
    
    // Listen for notes changes
    db.collection('attendance-system').doc('notes').onSnapshot((doc) => {
      if (doc.exists && !doc.metadata.hasPendingWrites) {
        const data = doc.data();
        Object.keys(studentNotes).forEach(key => delete studentNotes[key]);
        Object.assign(studentNotes, data.records || {});
        console.log('ğŸ”„ Notes synced from cloud');
      }
    });
    
    console.log('ğŸ”„ Real-time sync enabled');
  }
};

// Load from cloud on startup
window.addEventListener('load', async () => {
  if (isFirebaseEnabled) {
    const loaded = await CloudSync.loadFromCloud();
    if (loaded) {
      // Update UI
      setTimeout(() => {
        if (typeof updateAttendanceTable === 'function') updateAttendanceTable();
        if (typeof renderStudentList === 'function') renderStudentList();
        if (typeof Dashboard !== 'undefined' && typeof Dashboard.render === 'function') Dashboard.render();
      }, 500);
      
      // Enable real-time sync
      CloudSync.enableRealtimeSync();
      
      // Show success message
      setTimeout(() => {
        if (typeof NotificationSystem !== 'undefined') {
          NotificationSystem.show('â˜ï¸ Ù…ØªØµÙ„ Ø¨Ø§Ù„Ø³Ø­Ø§Ø¨Ø© - Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ÙÙˆØ±ÙŠØ© Ù…ÙØ¹Ù‘Ù„Ø©', 'success', 4000);
        }
      }, 1000);
    }
  }
});

// Override saveData to also save to cloud
const originalSaveData = saveData;
saveData = function() {
  // Save locally
  if (typeof DataPersistence !== 'undefined') {
    DataPersistence.saveAll();
  }
  
  // Save to cloud
  if (isFirebaseEnabled) {
    CloudSync.saveAll();
  }
};

let currentUser = null;
let isViewOnly = false;

function attemptLogin() {
  const password = document.getElementById('passwordInput').value.trim();
  const errorDiv = document.getElementById('loginError');
  
  if (!password) {
    showLoginError('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ');
    return;
  }
  
  if (ADMIN_PASSWORDS[password]) {
    currentUser = ADMIN_PASSWORDS[password];
    isViewOnly = false;
    
    // Update UI
    document.getElementById('loginModal').style.display = 'none';
    document.getElementById('viewModeOverlay').style.display = 'none';
    
    showToast(`âœ… Ù…Ø±Ø­Ø¨Ø§Ù‹ ${currentUser.name}`);
    enableEditMode();
  } else {
    showLoginError('âŒ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­');
    document.getElementById('passwordInput').value = '';
    document.getElementById('passwordInput').focus();
  }
}

function enterViewMode() {
  isViewOnly = true;
  currentUser = {name: 'Ø²Ø§Ø¦Ø±', role: 'Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø·'};
  
  document.getElementById('loginModal').style.display = 'none';
  document.getElementById('viewModeOverlay').style.display = 'block';
  
  showToast('ğŸ‘ï¸ Ø¯Ø®Ù„ØªÙ ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø·');
  disableEditMode();
}

function logout() {
  if (confirm('Ù‡Ù„ Ø£Ù†ØªÙ Ù…ØªØ£ÙƒØ¯Ø© Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ')) {
    currentUser = null;
    isViewOnly = false;
    document.getElementById('loginModal').style.display = 'flex';
    document.getElementById('viewModeOverlay').style.display = 'none';
    document.getElementById('passwordInput').value = '';
    showToast('ğŸšª ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­');
  }
}

function showLoginError(message) {
  const errorDiv = document.getElementById('loginError');
  errorDiv.textContent = message;
  errorDiv.style.display = 'block';
  setTimeout(() => {
    errorDiv.style.display = 'none';
  }, 3000);
}

function enableEditMode() {
  // Enable all buttons and inputs
  document.querySelectorAll('.btn, .form-input, .form-select, .att-cell, .btn-icon').forEach(el => {
    el.disabled = false;
    el.style.opacity = '1';
    el.style.cursor = 'pointer';
  });
}

function disableEditMode() {
  // Disable all edit buttons and inputs
  document.querySelectorAll('.btn-primary, .btn-success, .btn-danger, .form-input, .form-select, .att-cell, .btn-icon, .btn-delete, .btn-edit').forEach(el => {
    el.disabled = true;
    el.style.opacity = '0.5';
    el.style.cursor = 'not-allowed';
  });
  
  // Add click prevention
  document.addEventListener('click', preventEditInViewMode, true);
}

function preventEditInViewMode(e) {
  if (isViewOnly && (
    e.target.classList.contains('btn-primary') ||
    e.target.classList.contains('btn-success') ||
    e.target.classList.contains('btn-danger') ||
    e.target.classList.contains('att-cell') ||
    e.target.classList.contains('btn-icon') ||
    e.target.tagName === 'INPUT' ||
    e.target.tagName === 'SELECT' ||
    e.target.tagName === 'TEXTAREA'
  )) {
    e.preventDefault();
    e.stopPropagation();
    showToast('âš ï¸ ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø· - Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„');
    return false;
  }
}

// Check authentication on page load
window.addEventListener('load', () => {
  // Show login modal on page load
  document.getElementById('loginModal').style.display = 'flex';
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ATTENDANCE REGISTER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const ACADEMIC_DAYS = [
  // Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø£ÙˆÙ„: 29 Ø±Ø¬Ø¨ - 3 Ø´Ø¹Ø¨Ø§Ù† (27-31 ÙŠÙ†Ø§ÙŠØ± 2026)
  {date:'29/7',day:'Ø§Ù„Ø£Ø­Ø¯',hijri:'29 Ø±Ø¬Ø¨',week:1},
  {date:'30/7',day:'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†',hijri:'30 Ø±Ø¬Ø¨',week:1},
  {date:'1/8',day:'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡',hijri:'1 Ø´Ø¹Ø¨Ø§Ù†',week:1},
  {date:'2/8',day:'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡',hijri:'2 Ø´Ø¹Ø¨Ø§Ù†',week:1},
  {date:'3/8',day:'Ø§Ù„Ø®Ù…ÙŠØ³',hijri:'3 Ø´Ø¹Ø¨Ø§Ù†',week:1},
  
  // Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù†ÙŠ: 7-11 Ø´Ø¹Ø¨Ø§Ù† (3-7 ÙØ¨Ø±Ø§ÙŠØ±)
  {date:'7/8',day:'Ø§Ù„Ø£Ø­Ø¯',hijri:'7 Ø´Ø¹Ø¨Ø§Ù†',week:2},
  {date:'8/8',day:'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†',hijri:'8 Ø´Ø¹Ø¨Ø§Ù†',week:2},
  {date:'9/8',day:'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡',hijri:'9 Ø´Ø¹Ø¨Ø§Ù†',week:2},
  {date:'10/8',day:'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡',hijri:'10 Ø´Ø¹Ø¨Ø§Ù†',week:2},
  {date:'11/8',day:'Ø§Ù„Ø®Ù…ÙŠØ³',hijri:'11 Ø´Ø¹Ø¨Ø§Ù†',week:2},
  
  // Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù„Ø«: 14-18 Ø´Ø¹Ø¨Ø§Ù† (10-14 ÙØ¨Ø±Ø§ÙŠØ±)
  {date:'14/8',day:'Ø§Ù„Ø£Ø­Ø¯',hijri:'14 Ø´Ø¹Ø¨Ø§Ù†',week:3},
  {date:'15/8',day:'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†',hijri:'15 Ø´Ø¹Ø¨Ø§Ù†',week:3},
  {date:'16/8',day:'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡',hijri:'16 Ø´Ø¹Ø¨Ø§Ù†',week:3},
  {date:'17/8',day:'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡',hijri:'17 Ø´Ø¹Ø¨Ø§Ù†',week:3},
  {date:'18/8',day:'Ø§Ù„Ø®Ù…ÙŠØ³',hijri:'18 Ø´Ø¹Ø¨Ø§Ù†',week:3},
  
  // Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø±Ø§Ø¨Ø¹: 21-25 Ø´Ø¹Ø¨Ø§Ù† (17-21 ÙØ¨Ø±Ø§ÙŠØ±)
  {date:'21/8',day:'Ø§Ù„Ø£Ø­Ø¯',hijri:'21 Ø´Ø¹Ø¨Ø§Ù†',week:4},
  {date:'22/8',day:'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†',hijri:'22 Ø´Ø¹Ø¨Ø§Ù†',week:4},
  {date:'23/8',day:'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡',hijri:'23 Ø´Ø¹Ø¨Ø§Ù†',week:4},
  {date:'24/8',day:'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡',hijri:'24 Ø´Ø¹Ø¨Ø§Ù†',week:4},
  {date:'25/8',day:'Ø§Ù„Ø®Ù…ÙŠØ³',hijri:'25 Ø´Ø¹Ø¨Ø§Ù†',week:4},
  
  // Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø®Ø§Ù…Ø³: 28 Ø´Ø¹Ø¨Ø§Ù† - 3 Ø±Ù…Ø¶Ø§Ù† (24-28 ÙØ¨Ø±Ø§ÙŠØ±)
  {date:'28/8',day:'Ø§Ù„Ø£Ø­Ø¯',hijri:'28 Ø´Ø¹Ø¨Ø§Ù†',week:5},
  {date:'29/8',day:'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†',hijri:'29 Ø´Ø¹Ø¨Ø§Ù†',week:5},
  {date:'1/9',day:'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡',hijri:'1 Ø±Ù…Ø¶Ø§Ù†',week:5},
  {date:'2/9',day:'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡',hijri:'2 Ø±Ù…Ø¶Ø§Ù†',week:5},
  {date:'3/9',day:'Ø§Ù„Ø®Ù…ÙŠØ³',hijri:'3 Ø±Ù…Ø¶Ø§Ù†',week:5},
  
  // Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¯Ø³: 6-10 Ø±Ù…Ø¶Ø§Ù† (3-7 Ù…Ø§Ø±Ø³)
  {date:'6/9',day:'Ø§Ù„Ø£Ø­Ø¯',hijri:'6 Ø±Ù…Ø¶Ø§Ù†',week:6},
  {date:'7/9',day:'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†',hijri:'7 Ø±Ù…Ø¶Ø§Ù†',week:6},
  {date:'8/9',day:'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡',hijri:'8 Ø±Ù…Ø¶Ø§Ù†',week:6},
  {date:'9/9',day:'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡',hijri:'9 Ø±Ù…Ø¶Ø§Ù†',week:6},
  {date:'10/9',day:'Ø§Ù„Ø®Ù…ÙŠØ³',hijri:'10 Ø±Ù…Ø¶Ø§Ù†',week:6},
  
  // Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¨Ø¹: 13-17 Ø±Ù…Ø¶Ø§Ù† (10-14 Ù…Ø§Ø±Ø³)
  {date:'13/9',day:'Ø§Ù„Ø£Ø­Ø¯',hijri:'13 Ø±Ù…Ø¶Ø§Ù†',week:7},
  {date:'14/9',day:'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†',hijri:'14 Ø±Ù…Ø¶Ø§Ù†',week:7},
  {date:'15/9',day:'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡',hijri:'15 Ø±Ù…Ø¶Ø§Ù†',week:7},
  {date:'16/9',day:'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡',hijri:'16 Ø±Ù…Ø¶Ø§Ù†',week:7},
  {date:'17/9',day:'Ø§Ù„Ø®Ù…ÙŠØ³',hijri:'17 Ø±Ù…Ø¶Ø§Ù†',week:7},
  
  // Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù…Ù†: 20-24 Ø±Ù…Ø¶Ø§Ù† (17-21 Ù…Ø§Ø±Ø³)
  {date:'20/9',day:'Ø§Ù„Ø£Ø­Ø¯',hijri:'20 Ø±Ù…Ø¶Ø§Ù†',week:8},
  {date:'21/9',day:'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†',hijri:'21 Ø±Ù…Ø¶Ø§Ù†',week:8},
  {date:'22/9',day:'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡',hijri:'22 Ø±Ù…Ø¶Ø§Ù†',week:8},
  {date:'23/9',day:'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡',hijri:'23 Ø±Ù…Ø¶Ø§Ù†',week:8},
  {date:'24/9',day:'Ø§Ù„Ø®Ù…ÙŠØ³',hijri:'24 Ø±Ù…Ø¶Ø§Ù†',week:8},
  
  // Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„ØªØ§Ø³Ø¹: 27-30 Ø±Ù…Ø¶Ø§Ù† (24-27 Ù…Ø§Ø±Ø³) - Ø£Ø³Ø¨ÙˆØ¹ Ù‚ØµÙŠØ± Ù‚Ø¨Ù„ Ø¥Ø¬Ø§Ø²Ø© Ø§Ù„Ø¹ÙŠØ¯
  {date:'27/9',day:'Ø§Ù„Ø£Ø­Ø¯',hijri:'27 Ø±Ù…Ø¶Ø§Ù†',week:9},
  {date:'28/9',day:'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†',hijri:'28 Ø±Ù…Ø¶Ø§Ù†',week:9},
  {date:'29/9',day:'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡',hijri:'29 Ø±Ù…Ø¶Ø§Ù†',week:9},
  {date:'30/9',day:'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡',hijri:'30 Ø±Ù…Ø¶Ø§Ù†',week:9},
  
  // â”â”â”â”â”â”â” Ø¥Ø¬Ø§Ø²Ø© Ø¹ÙŠØ¯ Ø§Ù„ÙØ·Ø±: 1-18 Ø´ÙˆØ§Ù„ â”â”â”â”â”â”â”
  
  // Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø¹Ø§Ø´Ø± - Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø¹ÙŠØ¯: 19-23 Ø´ÙˆØ§Ù„ (14-18 Ø£Ø¨Ø±ÙŠÙ„)
  {date:'19/10',day:'Ø§Ù„Ø£Ø­Ø¯',hijri:'19 Ø´ÙˆØ§Ù„',week:10},
  {date:'20/10',day:'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†',hijri:'20 Ø´ÙˆØ§Ù„',week:10},
  {date:'21/10',day:'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡',hijri:'21 Ø´ÙˆØ§Ù„',week:10},
  {date:'22/10',day:'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡',hijri:'22 Ø´ÙˆØ§Ù„',week:10},
  {date:'23/10',day:'Ø§Ù„Ø®Ù…ÙŠØ³',hijri:'23 Ø´ÙˆØ§Ù„',week:10},
  
  // Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø­Ø§Ø¯ÙŠ Ø¹Ø´Ø±: 26-30 Ø´ÙˆØ§Ù„ (21-25 Ø£Ø¨Ø±ÙŠÙ„)
  {date:'26/10',day:'Ø§Ù„Ø£Ø­Ø¯',hijri:'26 Ø´ÙˆØ§Ù„',week:11},
  {date:'27/10',day:'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†',hijri:'27 Ø´ÙˆØ§Ù„',week:11},
  {date:'28/10',day:'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡',hijri:'28 Ø´ÙˆØ§Ù„',week:11},
  {date:'29/10',day:'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡',hijri:'29 Ø´ÙˆØ§Ù„',week:11},
  {date:'30/10',day:'Ø§Ù„Ø®Ù…ÙŠØ³',hijri:'30 Ø´ÙˆØ§Ù„',week:11},
  
  // Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¹Ø´Ø±: 3-7 Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø© (28 Ø£Ø¨Ø±ÙŠÙ„ - 2 Ù…Ø§ÙŠÙˆ)
  {date:'3/11',day:'Ø§Ù„Ø£Ø­Ø¯',hijri:'3 Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø©',week:12},
  {date:'4/11',day:'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†',hijri:'4 Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø©',week:12},
  {date:'5/11',day:'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡',hijri:'5 Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø©',week:12},
  {date:'6/11',day:'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡',hijri:'6 Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø©',week:12},
  {date:'7/11',day:'Ø§Ù„Ø®Ù…ÙŠØ³',hijri:'7 Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø©',week:12},
  
  // Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù„Ø« Ø¹Ø´Ø± - Ø§Ù„Ø£Ø®ÙŠØ±: 10-14 Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø© (5-9 Ù…Ø§ÙŠÙˆ)
  {date:'10/11',day:'Ø§Ù„Ø£Ø­Ø¯',hijri:'10 Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø©',week:13},
  {date:'11/11',day:'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†',hijri:'11 Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø©',week:13},
  {date:'12/11',day:'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡',hijri:'12 Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø©',week:13},
  {date:'13/11',day:'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡',hijri:'13 Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø©',week:13},
  {date:'14/11',day:'Ø§Ù„Ø®Ù…ÙŠØ³',hijri:'14 Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø©',week:13}
  
  // Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠ: 14 Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø© 1448 Ù‡Ù€
  // Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ø£ØµÙ„ÙŠ ÙŠÙ†ØªÙ‡ÙŠ ÙÙŠ 5 Ø´ÙˆØ§Ù„ØŒ Ù„ÙƒÙ† ØªÙ… Ø§Ù„ØªÙ…Ø¯ÙŠØ¯ Ø­Ø³Ø¨ Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ 1 Ø´ÙˆØ§Ù„
  // (ØªÙ… ØªØ¹Ø¯ÙŠÙ„Ù‡ Ù„ÙŠÙƒÙˆÙ† 14 Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø© Ù„ÙŠØ´Ù…Ù„ 13 Ø£Ø³Ø¨ÙˆØ¹ ÙƒØ§Ù…Ù„)
];

let attendanceData = {}; // {studentId-date: 'P'|'A'|'E'|'L'}

function updateAttendanceTable() {
  const grade = document.getElementById('registerGrade')?.value || 'all';
  const section = document.getElementById('registerSection')?.value || 'all';
  
  // Show loading notification
  if (typeof NotificationSystem !== 'undefined') {
    NotificationSystem.show('ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø¬Ù„...', 'info', 1000);
  }
  
  let filteredStudents = STUDENTS;
  if (grade !== 'all') {
    filteredStudents = filteredStudents.filter(s => s.grade === grade);
  }
  if (section !== 'all') {
    filteredStudents = filteredStudents.filter(s => s.section === section);
  }
  
  if (filteredStudents.length === 0) {
    document.getElementById('attendanceTableContainer').innerHTML = `
      <div style="background:#fff;padding:60px;border-radius:16px;border:1px solid var(--gray-200);text-align:center">
        <div style="font-size:48px;margin-bottom:16px">ğŸ‘¥</div>
        <div style="font-size:16px;font-weight:700;color:var(--navy);margin-bottom:8px">
          Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ø§Ù„Ø¨Ø§Øª
        </div>
        <div style="font-size:13px;color:var(--gray-600);margin-bottom:20px">
          Ø§Ø°Ù‡Ø¨ÙŠ Ù„ØªØ¨ÙˆÙŠØ¨ "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª" Ù„Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©
        </div>
        <button class="btn btn-primary" onclick="showTab('students')">
          â• Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨Ø§Øª
        </button>
      </div>
    `;
    
    // Show completion notification
    setTimeout(() => {
      if (typeof NotificationSystem !== 'undefined') {
        NotificationSystem.show('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø¬Ù„', 'success');
      }
    }, 500);
    return;
  }
  
  // Generate mock attendance data if not exists
  filteredStudents.forEach(s => {
    ACADEMIC_DAYS.forEach(d => {
      const key = `${s.id}-${d.date}`;
      if (!attendanceData[key]) {
        const statuses = ['P','P','P','P','A','E','L'];
        attendanceData[key] = statuses[Math.floor(Math.random() * statuses.length)];
      }
    });
  });
  
  let tableHtml = `
    <div style="background:#fff;border-radius:12px;border:1px solid var(--gray-200);overflow:hidden">
      <div style="overflow-x:auto">
        <table style="width:100%;border-collapse:collapse;min-width:2000px">
          <thead>
            <!-- Week Headers Row -->
            <tr style="background:linear-gradient(135deg,var(--blue-xs),var(--blue-lt))">
              <th rowspan="2" style="padding:12px;text-align:right;font-size:11px;font-weight:700;color:var(--teal);position:sticky;right:0;background:var(--teal-lt);z-index:10;border-left:2px solid var(--teal)">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨Ø©</th>
              ${(() => {
                let weekHeaders = '';
                let currentWeek = 1;
                let weekDayCount = 0;
                ACADEMIC_DAYS.forEach((d, i) => {
                  if (d.week !== currentWeek) {
                    weekHeaders += `<th colspan="${weekDayCount}" style="padding:10px;text-align:center;font-size:11px;font-weight:800;color:var(--blue);border-left:2px solid var(--blue)">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ${currentWeek}</th>`;
                    currentWeek = d.week;
                    weekDayCount = 1;
                  } else {
                    weekDayCount++;
                  }
                  if (i === ACADEMIC_DAYS.length - 1) {
                    weekHeaders += `<th colspan="${weekDayCount}" style="padding:10px;text-align:center;font-size:11px;font-weight:800;color:var(--blue);border-left:2px solid var(--blue)">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ${currentWeek}</th>`;
                  }
                });
                return weekHeaders;
              })()}
              <th rowspan="2" style="padding:12px;text-align:center;font-size:11px;font-weight:700;color:var(--present);background:var(--present-lt)">Ø­</th>
              <th rowspan="2" style="padding:12px;text-align:center;font-size:11px;font-weight:700;color:var(--absent);background:var(--absent-lt)">Øº</th>
              <th rowspan="2" style="padding:12px;text-align:center;font-size:11px;font-weight:700;color:var(--excused);background:var(--excused-lt)">Ø¹</th>
              <th rowspan="2" style="padding:12px;text-align:center;font-size:11px;font-weight:700;color:var(--late);background:var(--late-lt)">Øª</th>
              <th rowspan="2" style="padding:12px;text-align:center;font-size:11px;font-weight:700;color:var(--navy);background:var(--blue-xs)">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</th>
            </tr>
            <!-- Day Headers Row -->
            <tr style="background:var(--teal-lt);border-bottom:2px solid var(--teal)">
              ${ACADEMIC_DAYS.map((d, i) => {
                const isWeekEnd = i === ACADEMIC_DAYS.length - 1 || ACADEMIC_DAYS[i+1]?.week !== d.week;
                return `<th style="padding:10px;text-align:center;font-size:10px;font-weight:700;color:var(--teal);${isWeekEnd ? 'border-left:2px solid var(--blue);' : ''}">${d.day}<br><span style="font-size:9px">${d.hijri}</span></th>`;
              }).join('')}
            </tr>
          </thead>
          <tbody>
  `;
  
  filteredStudents.forEach((student, idx) => {
    let P=0, A=0, E=0, L=0;
    const initials = student.name.split(' ').slice(0,2).map(w=>w[0]).join('');
    
    tableHtml += `<tr style="border-bottom:1px solid var(--gray-100)" onmouseover="this.style.background='var(--teal-lt)'" onmouseout="this.style.background='#fff'">`;
    
    // Format phone for WhatsApp
    let formattedPhone = '';
    if (student.parentPhone && student.parentPhone.trim()) {
      formattedPhone = student.parentPhone.replace(/\s/g, '');
      if (formattedPhone.startsWith('05')) {
        formattedPhone = '966' + formattedPhone.substring(1);
      } else if (formattedPhone.startsWith('+966')) {
        formattedPhone = formattedPhone.substring(1);
      } else if (!formattedPhone.startsWith('966')) {
        formattedPhone = '966' + formattedPhone;
      }
    }
    
    tableHtml += `
      <td style="padding:12px;position:sticky;right:0;background:#fff;z-index:5;border-left:2px solid var(--gray-100)">
        <div style="display:flex;align-items:center;gap:10px">
          <div style="width:32px;height:32px;border-radius:50%;background:${student.color};display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:800;color:#fff">${initials}</div>
          <div style="flex:1">
            <div style="font-size:13px;font-weight:700;color:var(--navy)">${student.name}</div>
            <div style="font-size:10px;color:var(--gray-600)">${student.id}</div>
          </div>
          ${student.parentPhone ? `
            <button onclick="quickWhatsApp('${formattedPhone}', '${student.name.replace(/'/g, "\\'")}'); event.stopPropagation();" 
                    style="width:28px;height:28px;background:linear-gradient(135deg,#25D366,#128C7E);color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:14px;display:flex;align-items:center;justify-content:center;transition:all .2s;flex-shrink:0" 
                    onmouseover="this.style.transform='scale(1.15)';this.style.boxShadow='0 2px 8px rgba(37,211,102,.4)'" 
                    onmouseout="this.style.transform='scale(1)';this.style.boxShadow='none'"
                    title="ØªÙˆØ§ØµÙ„ Ù…Ø¹ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨">ğŸ’¬</button>
          ` : ''}
        </div>
      </td>
    `;
    
    ACADEMIC_DAYS.forEach((d, dayIndex) => {
      const key = `${student.id}-${d.date}`;
      const status = attendanceData[key] || '';
      const statusIcon = {P:'Ø­',A:'Øº',E:'Ø¹',L:'Øª'}[status] || 'â€”';
      const statusColor = {P:'var(--present)',A:'var(--absent)',E:'var(--excused)',L:'var(--late)'}[status] || 'var(--gray-400)';
      const statusBg = {P:'var(--present-lt)',A:'var(--absent-lt)',E:'var(--excused-lt)',L:'var(--late-lt)'}[status] || 'var(--gray-100)';
      
      if(status==='P')P++;else if(status==='A')A++;else if(status==='E')E++;else if(status==='L')L++;
      
      // Check if this is the last day of the week
      const isWeekEnd = dayIndex === ACADEMIC_DAYS.length - 1 || ACADEMIC_DAYS[dayIndex+1]?.week !== d.week;
      
      tableHtml += `
        <td style="padding:8px;text-align:center;${isWeekEnd ? 'border-left:2px solid var(--blue);' : ''}">
          <button onclick="toggleAttendance('${key}')" 
                  style="width:32px;height:28px;background:${statusBg};color:${statusColor};border:none;border-radius:6px;font-size:11px;font-weight:700;cursor:pointer;transition:all .2s"
                  onmouseover="this.style.transform='scale(1.1)'"
                  onmouseout="this.style.transform='scale(1)'">
            ${statusIcon}
          </button>
        </td>
      `;
    });
    
    tableHtml += `
      <td style="padding:12px;text-align:center;font-size:14px;font-weight:800;color:var(--present)">${P}</td>
      <td style="padding:12px;text-align:center;font-size:14px;font-weight:800;color:var(--absent)">${A}</td>
      <td style="padding:12px;text-align:center;font-size:14px;font-weight:800;color:var(--excused)">${E}</td>
      <td style="padding:12px;text-align:center;font-size:14px;font-weight:800;color:var(--late)">${L}</td>
    `;
    
    // Determine action based on unexcused absences
    if (A === 0) {
      // No absences - Certificate
      tableHtml += `
        <td style="padding:12px;text-align:center">
          <button onclick="openCertificate('${student.id}', 'perfect')" 
                  style="padding:6px 12px;background:linear-gradient(135deg,var(--present),#15803d);color:#fff;border:none;border-radius:8px;font-size:10px;font-weight:700;cursor:pointer;transition:all .2s;white-space:nowrap"
                  onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 4px 12px rgba(22,163,74,.3)'"
                  onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
            ğŸ† Ø´Ù‡Ø§Ø¯Ø© ØªÙƒØ±ÙŠÙ…
          </button>
        </td>
      `;
    } else if (A >= 3) {
      // 3+ unexcused absences - Parent Letter
      tableHtml += `
        <td style="padding:12px;text-align:center">
          <button onclick="openParentLetter('${student.id}')" 
                  style="padding:6px 12px;background:linear-gradient(135deg,var(--absent),#b91c1c);color:#fff;border:none;border-radius:8px;font-size:10px;font-weight:700;cursor:pointer;transition:all .2s;white-space:nowrap"
                  onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 4px 12px rgba(220,38,38,.3)'"
                  onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
            âœ‰ï¸ Ø®Ø·Ø§Ø¨ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±
          </button>
        </td>
      `;
    } else {
      // 1-2 absences - No action needed
      tableHtml += `
        <td style="padding:12px;text-align:center">
          <span style="font-size:11px;color:var(--gray-400)">â€”</span>
        </td>
      `;
    }
    
    tableHtml += `</tr>`;
  });
  
  tableHtml += `</tbody></table></div></div>`;
  document.getElementById('attendanceTableContainer').innerHTML = tableHtml;
}

function toggleAttendance(key) {
  if (isViewOnly) {
    showToast('âš ï¸ ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø· - Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„');
    return;
  }
  
  const current = attendanceData[key] || '';
  const cycle = {'': 'P', 'P': 'A', 'A': 'E', 'E': 'L', 'L': 'P'};
  attendanceData[key] = cycle[current];
  updateAttendanceTable();
  
  // Auto-save to cloud
  if (isFirebaseEnabled) {
    CloudSync.saveAttendance();
  } else {
    saveData();
  }
}

function exportAttendanceExcel() {
  showToast('ğŸ“Š Ø¬Ø§Ø±ÙŠ ØªØµØ¯ÙŠØ± Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±...');
  // Implementation here
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  REPORTS SYSTEM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function generateDailyReport() {
  document.getElementById('reportsEmptyState').style.display = 'none';
  document.getElementById('reportContent').style.display = 'block';
  
  const today = new Date().toLocaleDateString('ar-SA');
  document.getElementById('reportTitle').textContent = 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ';
  document.getElementById('reportDate').textContent = `Ø§Ù„ØªØ§Ø±ÙŠØ®: ${today} - ${ACADEMIC_DAYS[0].date} Ø´Ø¹Ø¨Ø§Ù† 1448 Ù‡Ù€`;
  
  generateReportStats('daily');
  generateReportCharts('daily');
  generateReportTable('daily');
  
  showToast('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ');
}

function generateWeeklyReport() {
  document.getElementById('reportsEmptyState').style.display = 'none';
  document.getElementById('reportContent').style.display = 'block';
  
  document.getElementById('reportTitle').textContent = 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ';
  document.getElementById('reportDate').textContent = 'Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø£ÙˆÙ„: 29 Ø±Ø¬Ø¨ - 3 Ø´Ø¹Ø¨Ø§Ù† 1448 Ù‡Ù€';
  
  generateReportStats('weekly');
  generateReportCharts('weekly');
  generateReportTable('weekly');
  
  showToast('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ');
}

function generateMonthlyReport() {
  document.getElementById('reportsEmptyState').style.display = 'none';
  document.getElementById('reportContent').style.display = 'block';
  
  document.getElementById('reportTitle').textContent = 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ';
  document.getElementById('reportDate').textContent = 'Ø´Ù‡Ø± Ø´Ø¹Ø¨Ø§Ù† 1448 Ù‡Ù€ (Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠ)';
  
  generateReportStats('monthly');
  generateReportCharts('monthly');
  generateReportTable('monthly');
  
  showToast('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ');
}

function generateReportStats(type) {
  const total = STUDENTS.length * ACADEMIC_DAYS.length;
  const P = Math.floor(total * 0.85);
  const A = Math.floor(total * 0.08);
  const E = Math.floor(total * 0.05);
  const L = total - P - A - E;
  
  document.getElementById('reportStats').innerHTML = `
    <div style="background:var(--blue-xs);padding:16px;border-radius:10px;text-align:center">
      <div style="font-size:28px;font-weight:900;color:var(--blue);margin-bottom:4px">${STUDENTS.length}</div>
      <div style="font-size:11px;color:var(--gray-600)">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª</div>
    </div>
    <div style="background:var(--present-lt);padding:16px;border-radius:10px;text-align:center">
      <div style="font-size:28px;font-weight:900;color:var(--present);margin-bottom:4px">${P}</div>
      <div style="font-size:11px;color:var(--gray-600)">Ø­Ø¶ÙˆØ±</div>
    </div>
    <div style="background:var(--absent-lt);padding:16px;border-radius:10px;text-align:center">
      <div style="font-size:28px;font-weight:900;color:var(--absent);margin-bottom:4px">${A}</div>
      <div style="font-size:11px;color:var(--gray-600)">ØºÙŠØ§Ø¨ Ø¨Ø¯ÙˆÙ† Ø¹Ø°Ø±</div>
    </div>
    <div style="background:var(--excused-lt);padding:16px;border-radius:10px;text-align:center">
      <div style="font-size:28px;font-weight:900;color:var(--excused);margin-bottom:4px">${E}</div>
      <div style="font-size:11px;color:var(--gray-600)">ØºÙŠØ§Ø¨ Ø¨Ø¹Ø°Ø±</div>
    </div>
    <div style="background:var(--late-lt);padding:16px;border-radius:10px;text-align:center">
      <div style="font-size:28px;font-weight:900;color:var(--late);margin-bottom:4px">${L}</div>
      <div style="font-size:11px;color:var(--gray-600)">ØªØ£Ø®ÙŠØ±</div>
    </div>
  `;
}

function generateReportCharts(type) {
  // Placeholder for charts - will use simple HTML/CSS charts
  document.getElementById('pieChart').outerHTML = `
    <div style="text-align:center;padding:40px">
      <div style="font-size:48px;margin-bottom:12px">ğŸ“Š</div>
      <div style="font-size:13px;color:var(--gray-600)">Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ø§Ù„Ø¯Ø§Ø¦Ø±ÙŠ</div>
    </div>
  `;
  
  document.getElementById('barChart').outerHTML = `
    <div style="text-align:center;padding:40px">
      <div style="font-size:48px;margin-bottom:12px">ğŸ“ˆ</div>
      <div style="font-size:13px;color:var(--gray-600)">Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ø§Ù„Ø´Ø±ÙŠØ·ÙŠ</div>
    </div>
  `;
}

function generateReportTable(type) {
  let tableHtml = `
    <table style="width:100%;border-collapse:collapse">
      <thead>
        <tr style="background:var(--gray-50)">
          <th style="padding:10px;text-align:right;border-bottom:2px solid var(--gray-200);font-size:12px">Ø§Ù„Ø·Ø§Ù„Ø¨Ø©</th>
          <th style="padding:10px;text-align:center;border-bottom:2px solid var(--gray-200);font-size:12px">Ø­Ø¶ÙˆØ±</th>
          <th style="padding:10px;text-align:center;border-bottom:2px solid var(--gray-200);font-size:12px">ØºÙŠØ§Ø¨</th>
          <th style="padding:10px;text-align:center;border-bottom:2px solid var(--gray-200);font-size:12px">Ø¹Ø°Ø±</th>
          <th style="padding:10px;text-align:center;border-bottom:2px solid var(--gray-200);font-size:12px">ØªØ£Ø®ÙŠØ±</th>
          <th style="padding:10px;text-align:center;border-bottom:2px solid var(--gray-200);font-size:12px">Ø§Ù„Ù†Ø³Ø¨Ø©</th>
        </tr>
      </thead>
      <tbody>
  `;
  
  STUDENTS.slice(0, 10).forEach(s => {
    const total = ACADEMIC_DAYS.length;
    const p = Math.floor(Math.random() * 3) + total - 3;
    const a = Math.floor(Math.random() * 2);
    const e = Math.floor(Math.random() * 2);
    const l = total - p - a - e;
    const pct = Math.round((p/total)*100);
    
    tableHtml += `
      <tr style="border-bottom:1px solid var(--gray-100)">
        <td style="padding:10px;font-size:12px;font-weight:600">${s.name}</td>
        <td style="padding:10px;text-align:center;color:var(--present);font-weight:700">${p}</td>
        <td style="padding:10px;text-align:center;color:var(--absent);font-weight:700">${a}</td>
        <td style="padding:10px;text-align:center;color:var(--excused);font-weight:700">${e}</td>
        <td style="padding:10px;text-align:center;color:var(--late);font-weight:700">${l}</td>
        <td style="padding:10px;text-align:center;font-weight:800;color:${pct>=90?'var(--present)':'var(--absent)'}">${pct}%</td>
      </tr>
    `;
  });
  
  tableHtml += '</tbody></table>';
  document.getElementById('reportTable').innerHTML = tableHtml;
}

function printReport() {
  window.print();
  showToast('ğŸ–¨ï¸ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©...');
}

function exportReportPDF() {
  showToast('ğŸ“„ Ø¬Ø§Ø±ÙŠ ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙƒÙ€ PDF...');
}

function exportReportExcel() {
  showToast('ğŸ“Š Ø¬Ø§Ø±ÙŠ ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙƒÙ€ Excel...');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STUDENT MANAGEMENT SYSTEM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let STUDENTS = [];
let studentIdCounter = 1;

const COLORS = [
  '#1e5ef3','#16a34a','#d97706','#7c3aed','#dc2626','#0d9488',
  '#db2777','#0284c7','#9333ea','#b45309','#0f766e','#be185d',
  '#2563eb','#059669','#c026d3','#ea580c','#0891b2','#7c2d12'
];

function addStudent() {
  if (isViewOnly) {
    showToast('âš ï¸ ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø· - Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨Ø§Øª');
    return;
  }
  
  const name = document.getElementById('studentName').value.trim();
  const grade = document.getElementById('studentGrade').value;
  const section = document.getElementById('studentSection').value;
  const parentPhone = document.getElementById('parentPhone').value.trim();
  
  if (!name) {
    showToast('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨Ø©');
    return;
  }
  
  const student = {
    id: `S${String(studentIdCounter).padStart(3, '0')}`,
    name: name,
    grade: grade,
    section: section,
    parentPhone: parentPhone || '',
    color: COLORS[(studentIdCounter - 1) % COLORS.length]
  };
  
  STUDENTS.push(student);
  studentIdCounter++;
  
  clearForm();
  renderStudents();
  updateCode();
  showToast('âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ø§Ù„Ø¨Ø© Ø¨Ù†Ø¬Ø§Ø­');
  
  // Auto-save to cloud
  if (isFirebaseEnabled) {
    CloudSync.saveStudents();
  } else {
    saveData();
  }
}

function importBulk() {
  if (isViewOnly) {
    showToast('âš ï¸ ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø· - Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø·Ø§Ù„Ø¨Ø§Øª');
    return;
  }
  
  const text = document.getElementById('bulkImport').value.trim();
  const grade = document.getElementById('bulkGrade').value;
  const section = document.getElementById('bulkSection').value;
  
  if (!text) {
    showToast('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù„ØµÙ‚ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª');
    return;
  }
  
  const names = text.split('\n').filter(n => n.trim());
  let count = 0;
  
  names.forEach(name => {
    const student = {
      id: `S${String(studentIdCounter).padStart(3, '0')}`,
      name: name.trim(),
      grade: grade,
      section: section,
      color: COLORS[(studentIdCounter - 1) % COLORS.length]
    };
    STUDENTS.push(student);
    studentIdCounter++;
    count++;
  });
  
  document.getElementById('bulkImport').value = '';
  renderStudents();
  updateCode();
  showToast(`âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${count} Ø·Ø§Ù„Ø¨Ø© Ø¨Ù†Ø¬Ø§Ø­`);
}

function deleteStudent(index) {
  if (isViewOnly) {
    showToast('âš ï¸ ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø· - Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø­Ø°Ù Ø·Ø§Ù„Ø¨Ø§Øª');
    return;
  }
  
  if (confirm('Ù‡Ù„ Ø£Ù†ØªÙ Ù…ØªØ£ÙƒØ¯Ø© Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø·Ø§Ù„Ø¨Ø©ØŸ')) {
    STUDENTS.splice(index, 1);
    renderStudents();
    updateCode();
    showToast('ğŸ—‘ï¸ ØªÙ… Ø­Ø°Ù Ø§Ù„Ø·Ø§Ù„Ø¨Ø©');
  }
}

function clearForm() {
  document.getElementById('studentName').value = '';
}

function clearAll() {
  if (confirm('Ù‡Ù„ Ø£Ù†ØªÙ Ù…ØªØ£ÙƒØ¯Ø© Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ø§Ù„Ø¨Ø§ØªØŸ')) {
    STUDENTS = [];
    studentIdCounter = 1;
    renderStudents();
    updateCode();
    showToast('ğŸ—‘ï¸ ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª');
  }
}

function renderStudents() {
  const list = document.getElementById('studentsList');
  document.getElementById('studentCount').textContent = STUDENTS.length;
  
  if (STUDENTS.length === 0) {
    list.innerHTML = '<div style="text-align:center;padding:40px;color:var(--gray-600)">Ù„Ù… ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯</div>';
    return;
  }
  
  let html = '';
  STUDENTS.forEach((s, i) => {
    const initials = s.name.split(' ').slice(0, 2).map(w => w[0]).join('');
    const gradeName = {first:'Ø§Ù„Ø£ÙˆÙ„',second:'Ø§Ù„Ø«Ø§Ù†ÙŠ',third:'Ø§Ù„Ø«Ø§Ù„Ø«'}[s.grade];
    
    // Format phone for WhatsApp
    let formattedPhone = '';
    if (s.parentPhone && s.parentPhone.trim()) {
      formattedPhone = s.parentPhone.replace(/\s/g, '');
      if (formattedPhone.startsWith('05')) {
        formattedPhone = '966' + formattedPhone.substring(1);
      } else if (formattedPhone.startsWith('+966')) {
        formattedPhone = formattedPhone.substring(1);
      } else if (!formattedPhone.startsWith('966')) {
        formattedPhone = '966' + formattedPhone;
      }
    }
    
    html += `
      <div class="student-item">
        <div class="student-avatar" style="background:${s.color}">${initials}</div>
        <div class="student-info">
          <div class="student-name">${s.name}</div>
          <div class="student-meta">${s.id} â€¢ ${gradeName} Ø«Ø§Ù†ÙˆÙŠ â€¢ Ø´Ø¹Ø¨Ø© ${s.section}</div>
          ${s.parentPhone ? `<div style="font-size:11px;color:var(--blue);margin-top:2px;direction:ltr;text-align:right">ğŸ“± ${s.parentPhone}</div>` : ''}
        </div>
        <div class="student-actions" style="display:flex;gap:6px;align-items:center">
          ${s.parentPhone ? `
            <button class="btn-icon" onclick="quickWhatsApp('${formattedPhone}', '${s.name.replace(/'/g, "\\'")}'); event.stopPropagation();" style="background:linear-gradient(135deg,#25D366,#128C7E);color:#fff;border:none;width:36px;height:36px;border-radius:8px;cursor:pointer;font-size:16px;display:flex;align-items:center;justify-content:center;transition:all .2s" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'" title="ØªÙˆØ§ØµÙ„ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨">ğŸ’¬</button>
          ` : ''}
          <button class="btn-icon btn-delete" onclick="deleteStudent(${i})">ğŸ—‘ï¸</button>
        </div>
      </div>
    `;
  });
  list.innerHTML = html;
}

function updateCode() {
  if (STUDENTS.length === 0) {
    document.getElementById('codeContent').textContent = '// Ù„Ù… ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯';
    return;
  }
  
  let code = 'const STUDENTS = [\n';
  STUDENTS.forEach((s, i) => {
    code += `  {id:'${s.id}', name:'${s.name}', grade:'${s.grade}', section:'${s.section}', color:'${s.color}'}`;
    if (i < STUDENTS.length - 1) code += ',';
    code += '\n';
  });
  code += '];';
  
  document.getElementById('codeContent').textContent = code;
}

function copyCode() {
  const code = document.getElementById('codeContent').textContent;
  navigator.clipboard.writeText(code).then(() => {
    showToast('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯ Ø¨Ù†Ø¬Ø§Ø­');
  });
}

function applyToSystem() {
  if (STUDENTS.length === 0) {
    showToast('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨Ø§Øª Ø£ÙˆÙ„Ø§Ù‹');
    return;
  }
  showToast('âœ… ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù…');
  // Here you would update the main attendance system with the new STUDENTS array
  console.log('Applied students:', STUDENTS);
}

function showToast(msg) {
  const toast = document.createElement('div');
  toast.style.cssText = 'position:fixed;bottom:24px;left:50%;transform:translateX(-50%);background:#0a2463;color:#fff;padding:12px 24px;border-radius:12px;font-family:Cairo,sans-serif;font-size:13px;font-weight:700;z-index:9999;box-shadow:0 8px 24px rgba(0,0,0,.3)';
  toast.textContent = msg;
  document.body.appendChild(toast);
  setTimeout(() => toast.remove(), 2500);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  TAB NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function showTab(tabName) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  
  document.getElementById('tab-' + tabName).classList.add('active');
  event.currentTarget.classList.add('active');
  
  // Update content based on tab
  if (tabName === 'register') {
    updateAttendanceTable();
  }
  if (tabName === 'admin') {
    renderAdminDashboard();
  }
  if (tabName === 'certificates') {
    generateCertificates();
  }
  if (tabName === 'reports') {
    setTimeout(() => {
      initializeCharts();
      updateDashboardStats();
      renderStudentsNotesTable();
    }, 100);
  }
}

function renderAdminDashboard() {
  const teamColors = {
    'Ù…Ø¯ÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©': '#ec4899',
    'ÙˆÙƒÙŠÙ„Ø© Ø´Ø¤ÙˆÙ† Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª': '#8b5cf6',
    'Ù…Ø¹Ù„Ù…Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©': '#1e5ef3',
    'Ù…Ø¹Ù„Ù…Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©': '#d97706',
    'Ù…Ø¹Ù„Ù…Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª': '#16a34a',
    'Ù…Ø¹Ù„Ù…Ø© Ø§Ù„Ø¹Ù„ÙˆÙ…': '#7c3aed',
    'Ù…Ø±Ø´Ø¯Ø© Ø·Ù„Ø§Ø¨ÙŠØ©': '#14b8a6',
    'Ù…ÙˆØ¬Ù‡Ø© Ø·Ù„Ø§Ø¨ÙŠØ©': '#06b6d4',
    'Ø¥Ø¯Ø§Ø±ÙŠØ©': '#f59e0b',
    'Ù…Ø¹Ù„Ù…Ø©': '#0d9488'
  };
  
  const teamMembers = Object.entries(ADMIN_PASSWORDS).map(([password, user]) => ({
    ...user,
    password: password,
    color: teamColors[user.role] || '#0d9488',
    online: currentUser && currentUser.name === user.name
  }));
  
  let html = '';
  teamMembers.forEach((member, index) => {
    const initials = member.name.split(' ').slice(0,2).map(w=>w[0]).join('');
    const statusColor = member.online ? 'var(--present)' : 'var(--gray-400)';
    const statusText = member.online ? 'â— Ù…ØªØµÙ„ Ø§Ù„Ø¢Ù†' : 'â—‹ ØºÙŠØ± Ù…ØªØµÙ„';
    const statusBg = member.online ? 'var(--present-lt)' : 'var(--gray-100)';
    
    html += `
      <div style="display:flex;align-items:center;gap:14px;padding:14px;background:var(--gray-50);border-radius:12px;transition:all .2s;border:2px solid ${member.online ? 'var(--present)' : 'transparent'}" 
           onmouseover="this.style.background='var(--blue-xs)'" 
           onmouseout="this.style.background='var(--gray-50)'">
        <div style="width:48px;height:48px;border-radius:50%;background:${member.color};display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:800;color:#fff;flex-shrink:0">
          ${initials}
        </div>
        <div style="flex:1">
          <div style="font-size:14px;font-weight:700;color:var(--navy);margin-bottom:2px">${member.name}</div>
          <div style="font-size:11px;color:var(--gray-600)">${member.role}</div>
        </div>
        <div style="text-align:center;min-width:100px">
          <div style="display:inline-block;padding:6px 12px;background:${statusBg};border-radius:8px;font-size:11px;font-weight:700;color:${statusColor};margin-bottom:4px">
            ${statusText}
          </div>
          <div style="font-size:10px;color:var(--gray-400)">Ø±Ù‚Ù… Ø³Ø±ÙŠ: ${member.password}</div>
        </div>
        <div style="display:flex;gap:6px;flex-shrink:0">
          <button onclick="editMember('${member.password}')" style="padding:8px 14px;background:var(--blue);color:#fff;border:none;border-radius:8px;font-size:12px;font-weight:700;cursor:pointer;transition:all .2s;box-shadow:0 2px 4px rgba(30,94,243,.2)" onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 4px 8px rgba(30,94,243,.3)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 2px 4px rgba(30,94,243,.2)'">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
          <button onclick="deleteMember('${member.password}', '${member.name.replace(/'/g, "\\'")}');" style="padding:8px 14px;background:var(--absent);color:#fff;border:none;border-radius:8px;font-size:12px;font-weight:700;cursor:pointer;transition:all .2s;box-shadow:0 2px 4px rgba(220,38,38,.2)" onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 4px 8px rgba(220,38,38,.3)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 2px 4px rgba(220,38,38,.2)'">ğŸ—‘ï¸ Ø­Ø°Ù</button>
        </div>
      </div>
    `;
  });
  
  document.getElementById('teamMembersList').innerHTML = html;
  
  // Update online count and total count
  const onlineCount = teamMembers.filter(m => m.online).length;
  document.getElementById('onlineCount').textContent = onlineCount;
  
  // Update total team count in KPI
  const kpis = document.querySelectorAll('#tab-admin .page > div:first-child > div');
  if (kpis[0]) {
    kpis[0].querySelector('div').textContent = teamMembers.length;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CERTIFICATES SYSTEM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function generateCertificates() {
  if (STUDENTS.length === 0) {
    showToast('âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ø§Ù„Ø¨Ø§Øª ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…');
    return;
  }
  
  // Mock attendance data for demo
  const studentsWithAttendance = STUDENTS.map(s => {
    const totalDays = 20;
    const present = Math.floor(Math.random() * 5) + 16; // 16-20 days
    const percentage = Math.round((present / totalDays) * 100);
    return {
      ...s,
      totalDays,
      present,
      percentage,
      absent: totalDays - present
    };
  });
  
  const perfectAttendance = studentsWithAttendance.filter(s => s.percentage === 100);
  const excellentAttendance = studentsWithAttendance.filter(s => s.percentage >= 95 && s.percentage < 100);
  const goodAttendance = studentsWithAttendance.filter(s => s.percentage >= 90 && s.percentage < 95);
  
  document.getElementById('perfectAttendanceCount').textContent = perfectAttendance.length;
  document.getElementById('excellentAttendanceCount').textContent = excellentAttendance.length;
  document.getElementById('goodAttendanceCount').textContent = goodAttendance.length;
  
  let html = '';
  
  // Perfect attendance certificates
  perfectAttendance.forEach(student => {
    html += renderCertificateCard(student, 'perfect');
  });
  
  // Excellent attendance certificates
  excellentAttendance.forEach(student => {
    html += renderCertificateCard(student, 'excellent');
  });
  
  if (html === '') {
    html = '<div style="grid-column:1/-1;text-align:center;padding:60px;color:var(--gray-400)"><div style="font-size:48px;margin-bottom:12px">ğŸ†</div><div style="font-size:16px;font-weight:600">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ø§Ù„Ø¨Ø§Øª Ù…Ø³ØªØ­Ù‚Ø§Øª Ù„Ø´Ù‡Ø§Ø¯Ø§Øª Ø§Ù„Ø´ÙƒØ± Ø­Ø§Ù„ÙŠØ§Ù‹</div><div style="font-size:13px;margin-top:6px">Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±</div></div>';
  }
  
  document.getElementById('certificatesGrid').innerHTML = html;
  showToast('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª');
}

function renderCertificateCard(student, level) {
  const badge = level === 'perfect' ? 'ğŸ¥‡ Ø­Ø¶ÙˆØ± Ù…Ø«Ø§Ù„ÙŠ' : 'ğŸ¥ˆ Ø­Ø¶ÙˆØ± Ù…Ù…ØªØ§Ø²';
  const badgeColor = level === 'perfect' ? 'var(--present)' : 'var(--blue)';
  const badgeBg = level === 'perfect' ? 'var(--present-lt)' : 'var(--blue-lt)';
  
  return `
    <div style="background:var(--gray-50);border-radius:12px;padding:16px;border:2px solid ${level==='perfect'?'var(--present)':'var(--blue)'};transition:all .2s;cursor:pointer"
         onmouseover="this.style.transform='translateY(-4px)';this.style.boxShadow='var(--shadow-md)'"
         onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'"
         onclick="openCertificate('${student.id}', '${level}')">
      <div style="display:flex;align-items:center;gap:10px;margin-bottom:12px">
        <div style="width:44px;height:44px;border-radius:50%;background:${student.color};display:flex;align-items:center;justify-content:center;font-size:16px;font-weight:800;color:#fff">
          ${student.name.split(' ').slice(0,2).map(w=>w[0]).join('')}
        </div>
        <div style="flex:1">
          <div style="font-size:13px;font-weight:700;color:var(--navy)">${student.name}</div>
          <div style="font-size:10px;color:var(--gray-600)">${student.id}</div>
        </div>
      </div>
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px">
        <span style="font-size:11px;color:var(--gray-600)">Ù†Ø³Ø¨Ø© Ø§Ù„Ø­Ø¶ÙˆØ±</span>
        <span style="font-size:18px;font-weight:900;color:${badgeColor}">${student.percentage}%</span>
      </div>
      <div style="padding:8px 12px;background:${badgeBg};color:${badgeColor};border-radius:8px;font-size:11px;font-weight:700;text-align:center;margin-bottom:10px">
        ${badge}
      </div>
      <button style="width:100%;padding:8px;background:linear-gradient(135deg,var(--blue),var(--navy));color:#fff;border:none;border-radius:8px;font-family:'Cairo',sans-serif;font-size:11px;font-weight:700;cursor:pointer"
              onclick="event.stopPropagation();openCertificate('${student.id}', '${level}')">
        ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©
      </button>
    </div>
  `;
}

function openCertificate(studentId, level) {
  const student = STUDENTS.find(s => s.id === studentId);
  if (!student) return;
  
  const today = new Date().toLocaleDateString('ar-SA');
  const certificateHtml = `
    <div style="width:210mm;min-height:297mm;padding:30mm;background:#fff;position:relative;font-family:'Amiri',serif">
      <!-- Decorative Border -->
      <div style="position:absolute;inset:15mm;border:4px double ${level==='perfect'?'#FFD700':'var(--blue)'};border-radius:20px"></div>
      <div style="position:absolute;inset:17mm;border:2px solid ${level==='perfect'?'#FFD700':'var(--blue)'};border-radius:18px"></div>
      
      <!-- Content -->
      <div style="position:relative;z-index:1;text-align:center">
        <!-- Header -->
        <div style="margin-bottom:20mm;text-align:center">
          <div style="font-size:16px;color:#14b8a6;font-weight:700;margin-bottom:5mm">Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</div>
          <div style="font-size:18px;color:var(--navy);font-weight:800;margin-bottom:5mm">ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…</div>
          <div style="font-size:14px;color:var(--gray-600);margin-bottom:3mm">Ø¥Ø¯Ø§Ø±Ø© ØªØ¹Ù„ÙŠÙ… Ø¬Ø§Ø²Ø§Ù†</div>
          <div style="font-size:14px;color:var(--navy);font-weight:700">Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¨Ø¬Ø§Ø²Ø§Ù†</div>
        </div>
        
        <!-- Certificate Icon -->
        <div style="font-size:60px;margin-bottom:10mm">${level==='perfect'?'ğŸ¥‡':'ğŸ¥ˆ'}</div>
        
        <!-- Title -->
        <div style="font-size:32px;font-weight:900;color:var(--navy);margin-bottom:15mm;text-decoration:underline;text-decoration-color:${level==='perfect'?'#FFD700':'var(--blue)'}">
          Ø´Ù€Ù‡Ù€Ø§Ø¯Ø© Ø´Ù€ÙƒÙ€Ø± ÙˆØªÙ€Ù‚Ù€Ø¯ÙŠÙ€Ø±
        </div>
        
        <!-- Body -->
        <div style="font-size:18px;line-height:2.5;color:var(--gray-800);margin-bottom:15mm">
          <p style="margin-bottom:10mm">ØªÙÙ€Ù‡Ù€Ø¯ÙŠ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¨Ø¬Ø§Ø²Ø§Ù†</p>
          <p style="margin-bottom:10mm">Ù‡Ø°Ù‡ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø·Ø§Ù„Ø¨Ø© Ø§Ù„Ù…ØªÙ…ÙŠØ²Ø©</p>
          <div style="font-size:28px;font-weight:900;color:${level==='perfect'?'#FFD700':'var(--blue)'};margin:15mm 0;padding:10mm;background:${level==='perfect'?'rgba(255,215,0,.1)':'var(--blue-xs)'};border-radius:12px">
            ${student.name}
          </div>
          <p style="margin-bottom:10mm">ÙˆØ°Ù„Ùƒ ØªÙ‚Ø¯ÙŠØ±Ø§Ù‹ Ù„Ø­Ø¶ÙˆØ±Ù‡Ø§ ${level==='perfect'?'Ø§Ù„Ù…Ø«Ø§Ù„ÙŠ ÙˆØ§Ù„Ù…ØªÙ…ÙŠØ²':'Ø§Ù„Ù…Ù…ØªØ§Ø²'}</p>
          <p>ÙˆØ§Ù„ØªØ²Ø§Ù…Ù‡Ø§ Ø¨Ø§Ù„Ø§Ù†Ø¶Ø¨Ø§Ø· Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ</p>
        </div>
        
        <!-- Stats -->
        <div style="display:inline-block;background:var(--gray-50);padding:15mm;border-radius:12px;margin-bottom:15mm">
          <div style="font-size:48px;font-weight:900;color:${level==='perfect'?'#FFD700':'var(--blue)'};margin-bottom:5mm">100%</div>
          <div style="font-size:14px;color:var(--gray-600)">Ù†Ø³Ø¨Ø© Ø§Ù„Ø­Ø¶ÙˆØ± Ø®Ù„Ø§Ù„ Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠ</div>
        </div>
        
        <!-- Footer with Signatures and Stamp -->
        <div style="display:flex;justify-content:space-between;align-items:end;margin-top:20mm;padding-top:10mm;border-top:2px solid var(--gray-200)">
          <!-- Principal Signature -->
          <div style="text-align:center;position:relative">
            <div style="font-size:12px;color:var(--gray-600);margin-bottom:5mm">Ù…Ø¯ÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</div>
            <img src="signature-principal.jpg" style="width:40mm;height:auto;max-height:25mm;object-fit:contain;margin-bottom:3mm" onerror="this.style.display='none'">
            <div style="font-size:16px;font-weight:700;color:var(--navy);border-top:2px solid var(--navy);padding-top:3mm;min-width:50mm">Ø£. Ù‡Ø¨Ù‡ ØµÙ…</div>
          </div>
          
          <!-- Date and Stamp -->
          <div style="text-align:center;position:relative">
            <div style="font-size:12px;color:var(--gray-600);margin-bottom:5mm">Ø§Ù„ØªØ§Ø±ÙŠØ®</div>
            <div style="font-size:14px;font-weight:700;color:var(--navy);margin-bottom:5mm">${today}</div>
            <img src="school-stamp.jpg" style="width:50mm;height:auto;max-height:50mm;object-fit:contain;opacity:0.9" onerror="this.style.display='none'">
            <div style="font-size:12px;color:var(--gray-600);margin-top:3mm">Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ 1447-1448 Ù‡Ù€</div>
          </div>
          
          <!-- Supervisor Signature -->
          <div style="text-align:center">
            <div style="font-size:12px;color:var(--gray-600);margin-bottom:5mm">ÙˆÙƒÙŠÙ„Ø© Ø´Ø¤ÙˆÙ† Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª</div>
            <div style="height:25mm;display:flex;align-items:center;justify-content:center;margin-bottom:3mm">
              <div style="font-size:11px;color:var(--gray-400)">Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</div>
            </div>
            <div style="font-size:16px;font-weight:700;color:var(--navy);border-top:2px solid var(--navy);padding-top:3mm;min-width:50mm">Ø£. Ø¹ÙŠØ´Ø© Ø¹ÙˆØ§Ø¬ÙŠ</div>
          </div>
        </div>
      </div>
    </div>
  `;
  
  document.getElementById('certificateContent').innerHTML = certificateHtml;
  document.getElementById('certificateModal').style.display = 'block';
}

function closeCertificate() {
  document.getElementById('certificateModal').style.display = 'none';
}

function openParentLetter(studentId) {
  const student = STUDENTS.find(s => s.id === studentId);
  if (!student) return;
  
  // Count absences
  let P=0, A=0, E=0, L=0, total=0;
  ACADEMIC_DAYS.forEach(d => {
    const key = `${student.id}-${d.date}`;
    const status = attendanceData[key];
    if(status==='P')P++;else if(status==='A')A++;else if(status==='E')E++;else if(status==='L')L++;
    if(status)total++;
  });
  
  const today = new Date().toLocaleDateString('ar-SA');
  const percentage = total > 0 ? Math.round((P / total) * 100) : 0;
  
  const letterHtml = `
    <div style="width:210mm;min-height:297mm;padding:20mm;background:#fff;font-family:'Amiri',serif;position:relative">
      <!-- Header -->
      <div style="text-align:center;margin-bottom:15mm;padding-bottom:10mm;border-bottom:3px solid var(--navy)">
        <div style="font-size:14px;color:#14b8a6;font-weight:700;margin-bottom:3mm">Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</div>
        <div style="font-size:16px;color:var(--navy);font-weight:800;margin-bottom:3mm">ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…</div>
        <div style="font-size:12px;color:var(--gray-600);margin-bottom:2mm">Ø¥Ø¯Ø§Ø±Ø© ØªØ¹Ù„ÙŠÙ… Ø¬Ø§Ø²Ø§Ù†</div>
        <div style="font-size:12px;color:var(--navy);font-weight:700">Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¨Ø¬Ø§Ø²Ø§Ù†</div>
      </div>
      
      <!-- Letter Content -->
      <div style="margin-bottom:15mm">
        <div style="text-align:right;margin-bottom:10mm">
          <div style="font-size:14px;margin-bottom:5mm">Ø§Ù„ØªØ§Ø±ÙŠØ®: ${today}</div>
          <div style="font-size:14px">Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹: <span style="font-weight:700;color:var(--absent)">Ø¥Ø´Ø¹Ø§Ø± ÙˆÙ„ÙŠ Ø£Ù…Ø± Ø·Ø§Ù„Ø¨Ø© Ø¨Ø§Ù„ØºÙŠØ§Ø¨</span></div>
        </div>
        
        <div style="font-size:16px;line-height:2.5;text-align:justify">
          <p style="margin-bottom:8mm">Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ… ÙˆØ±Ø­Ù…Ø© Ø§Ù„Ù„Ù‡ ÙˆØ¨Ø±ÙƒØ§ØªÙ‡ØŒØŒØŒ</p>
          
          <p style="margin-bottom:8mm">ÙˆÙ„ÙŠ Ø£Ù…Ø± Ø§Ù„Ø·Ø§Ù„Ø¨Ø© / <span style="font-weight:800;color:var(--navy);font-size:18px">${student.name}</span></p>
          
          <p style="margin-bottom:8mm">ØªØ­ÙŠØ© Ø·ÙŠØ¨Ø© ÙˆØ¨Ø¹Ø¯ØŒØŒØŒ</p>
          
          <p style="margin-bottom:8mm">Ù†Ø­ÙŠØ·ÙƒÙ… Ø¹Ù„Ù…Ø§Ù‹ Ø¨Ø£Ù† Ø§Ø¨Ù†ØªÙƒÙ… Ø§Ù„Ø·Ø§Ù„Ø¨Ø© Ø§Ù„Ù…Ø°ÙƒÙˆØ±Ø© Ø£Ø¹Ù„Ø§Ù‡ Ù‚Ø¯ ØªØºÙŠØ¨Øª Ø¹Ù† Ø§Ù„Ø¯ÙˆØ§Ù… Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ Ø¨Ø¯ÙˆÙ† Ø¹Ø°Ø± Ù…Ù‚Ø¨ÙˆÙ„ØŒ ÙˆØ°Ù„Ùƒ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø­Ùˆ Ø§Ù„ØªØ§Ù„ÙŠ:</p>
        </div>
        
        <!-- Attendance Statistics Table -->
        <div style="margin:10mm 0;padding:8mm;background:var(--gray-50);border-radius:8px;border:2px solid var(--absent)">
          <table style="width:100%;border-collapse:collapse;font-size:14px">
            <thead>
              <tr style="background:var(--absent-lt)">
                <th style="padding:8px;border:1px solid var(--absent);text-align:center;font-weight:700">Ø§Ù„Ø¨ÙŠØ§Ù†</th>
                <th style="padding:8px;border:1px solid var(--absent);text-align:center;font-weight:700;color:var(--present)">Ø­Ø¶ÙˆØ±</th>
                <th style="padding:8px;border:1px solid var(--absent);text-align:center;font-weight:700;color:var(--absent)">ØºÙŠØ§Ø¨ Ø¨Ø¯ÙˆÙ† Ø¹Ø°Ø±</th>
                <th style="padding:8px;border:1px solid var(--absent);text-align:center;font-weight:700;color:var(--excused)">ØºÙŠØ§Ø¨ Ø¨Ø¹Ø°Ø±</th>
                <th style="padding:8px;border:1px solid var(--absent);text-align:center;font-weight:700;color:var(--late)">ØªØ£Ø®ÙŠØ±</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="padding:8px;border:1px solid var(--gray-200);text-align:center;font-weight:700">Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…</td>
                <td style="padding:8px;border:1px solid var(--gray-200);text-align:center;font-weight:800;font-size:16px;color:var(--present)">${P}</td>
                <td style="padding:8px;border:1px solid var(--gray-200);text-align:center;font-weight:800;font-size:16px;color:var(--absent)">${A}</td>
                <td style="padding:8px;border:1px solid var(--gray-200);text-align:center;font-weight:800;font-size:16px;color:var(--excused)">${E}</td>
                <td style="padding:8px;border:1px solid var(--gray-200);text-align:center;font-weight:800;font-size:16px;color:var(--late)">${L}</td>
              </tr>
              <tr>
                <td style="padding:8px;border:1px solid var(--gray-200);text-align:center;font-weight:700">Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©</td>
                <td style="padding:8px;border:1px solid var(--gray-200);text-align:center;font-weight:800;color:var(--present)">${percentage}%</td>
                <td style="padding:8px;border:1px solid var(--gray-200);text-align:center;font-weight:800;color:var(--absent)">${Math.round((A/total)*100)}%</td>
                <td style="padding:8px;border:1px solid var(--gray-200);text-align:center;font-weight:800;color:var(--excused)">${Math.round((E/total)*100)}%</td>
                <td style="padding:8px;border:1px solid var(--gray-200);text-align:center;font-weight:800;color:var(--late)">${Math.round((L/total)*100)}%</td>
              </tr>
            </tbody>
          </table>
        </div>
        
        <div style="font-size:16px;line-height:2.5;text-align:justify">
          <p style="margin-bottom:8mm">Ù†Ø£Ù…Ù„ Ù…Ù† Ø³ÙŠØ§Ø¯ØªÙƒÙ… Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ø¨Ù†ØªÙƒÙ… ÙˆØ§Ù„ØªØ£ÙƒÙŠØ¯ Ø¹Ù„ÙŠÙ‡Ø§ Ø¨Ø£Ù‡Ù…ÙŠØ© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ù… ÙÙŠ Ø§Ù„Ø¯ÙˆØ§Ù… Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØŒ Ø­ÙŠØ« Ø£Ù† ÙƒØ«Ø±Ø© Ø§Ù„ØºÙŠØ§Ø¨ ØªØ¤Ø«Ø± Ø³Ù„Ø¨Ø§Ù‹ Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆØ§Ù‡Ø§ Ø§Ù„ØªØ­ØµÙŠÙ„ÙŠ.</p>
          
          <p style="margin-bottom:8mm;padding:8mm;background:var(--absent-lt);border-right:4px solid var(--absent);border-radius:4px">
            <span style="font-weight:700;color:var(--absent)">ØªÙ†Ø¨ÙŠÙ‡ Ù‡Ø§Ù…:</span> ÙÙŠ Ø­Ø§Ù„ Ø§Ø³ØªÙ…Ø±Ø§Ø± Ø§Ù„ØºÙŠØ§Ø¨ Ø§Ù„Ù…ØªÙƒØ±Ø±ØŒ Ø³ØªØ¶Ø·Ø± Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ù„Ø§ØªØ®Ø§Ø° Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…ÙŠØ© ÙˆÙÙ‚Ø§Ù‹ Ù„Ù„ÙˆØ§Ø¦Ø­ ÙˆØ§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ù…Ø¹Ù…ÙˆÙ„ Ø¨Ù‡Ø§.
          </p>
          
          <p>Ø´Ø§ÙƒØ±ÙŠÙ† Ù„ÙƒÙ… Ø­Ø³Ù† ØªØ¹Ø§ÙˆÙ†ÙƒÙ…ØŒØŒØŒ</p>
        </div>
      </div>
      
      <!-- Signatures with Stamp -->
      <div style="display:flex;justify-content:space-between;align-items:end;margin-top:20mm;padding-top:10mm;border-top:2px solid var(--gray-200)">
        <!-- Principal Signature -->
        <div style="text-align:center;position:relative">
          <div style="font-size:12px;color:var(--gray-600);margin-bottom:5mm">Ù…Ø¯ÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</div>
          <img src="signature-principal.jpg" style="width:40mm;height:auto;max-height:25mm;object-fit:contain;margin-bottom:3mm" onerror="this.style.display='none'">
          <div style="font-size:14px;font-weight:700;color:var(--navy);border-top:2px solid var(--navy);padding-top:5mm;min-width:60mm">Ø£. Ù‡Ø¨Ù‡ ØµÙ…</div>
        </div>
        
        <!-- School Stamp -->
        <div style="text-align:center;position:relative">
          <div style="font-size:11px;color:var(--gray-600);margin-bottom:3mm">Ø®ØªÙ… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</div>
          <img src="school-stamp.jpg" style="width:60mm;height:auto;max-height:60mm;object-fit:contain;opacity:0.9" onerror="this.style.display='none'">
        </div>
        
        <!-- Supervisor Signature -->
        <div style="text-align:center">
          <div style="font-size:12px;color:var(--gray-600);margin-bottom:5mm">ÙˆÙƒÙŠÙ„Ø© Ø´Ø¤ÙˆÙ† Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª</div>
          <div style="height:25mm;display:flex;align-items:center;justify-content:center;margin-bottom:3mm">
            <div style="font-size:11px;color:var(--gray-400)">Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</div>
          </div>
          <div style="font-size:14px;font-weight:700;color:var(--navy);border-top:2px solid var(--navy);padding-top:5mm;min-width:60mm">Ø£. Ø¹ÙŠØ´Ø© Ø¹ÙˆØ§Ø¬ÙŠ</div>
        </div>
      </div>
      </div>
    </div>
  `;
  
  document.getElementById('certificateContent').innerHTML = letterHtml;
  document.getElementById('certificateModal').style.display = 'block';
}

function printAllCertificates() {
  showToast('ğŸ–¨ï¸ Ø¬Ø§Ø±ÙŠ ØªØ¬Ù‡ÙŠØ² Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©...');
  // Implementation for batch printing
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

renderStudents();
updateCode();
updateAttendanceTable();

// Add some sample data for demo
setTimeout(() => {
  document.getElementById('headerStats').innerHTML = `
    <div class="header-stat"><div class="sv">${STUDENTS.length}</div><div class="sl">Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª</div></div>
    <div class="header-stat"><div class="sv">13</div><div class="sl">Ø£Ø³Ø§Ø¨ÙŠØ¹</div></div>
    <div class="header-stat"><div class="sv">29/7</div><div class="sl">Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ÙØµÙ„</div></div>
  `;
}, 100);

console.log('âœ… Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ÙƒØ§Ù…Ù„ Ø¬Ø§Ù‡Ø²!');
console.log('ğŸ“‹ Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª: Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª + Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ± + Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± + Ø´Ù‡Ø§Ø¯Ø§Øª + Ø®Ø·Ø§Ø¨Ø§Øª + Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©');
console.log('ğŸ“… Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ÙØµÙ„: 29 Ø±Ø¬Ø¨ 1448 Ù‡Ù€ (27 ÙŠÙ†Ø§ÙŠØ± 2026 Ù…)');

// Auto-update attendance table when students change
setTimeout(() => {
  if (typeof updateAttendanceTable === 'function') {
    updateAttendanceTable();
  }
}, 1000);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ENHANCED FEATURES - Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//  1. Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const NotificationSystem = {
  show(message, type = 'info', duration = 4000) {
    const icons = {success: 'âœ…', warning: 'âš ï¸', error: 'âŒ', info: 'â„¹ï¸', alert: 'ğŸ””'};
    const colors = {success: 'var(--present)', warning: 'var(--excused)', error: 'var(--absent)', info: 'var(--blue)', alert: 'var(--late)'};
    
    const notification = document.createElement('div');
    notification.style.cssText = `position:fixed;top:80px;left:50%;transform:translateX(-50%) translateY(-100px);background:${colors[type]};color:#fff;padding:16px 24px;border-radius:12px;font-family:'Cairo',sans-serif;font-size:14px;font-weight:700;z-index:10000;box-shadow:0 8px 24px rgba(0,0,0,.2);display:flex;align-items:center;gap:12px;min-width:300px;max-width:500px;transition:all .3s`;
    notification.innerHTML = `<span style="font-size:20px">${icons[type]}</span><span style="flex:1">${message}</span><button onclick="this.parentElement.remove()" style="background:rgba(255,255,255,.2);border:none;color:#fff;width:24px;height:24px;border-radius:50%;cursor:pointer;font-size:16px">Ã—</button>`;
    
    document.body.appendChild(notification);
    setTimeout(() => notification.style.transform = 'translateX(-50%) translateY(0)', 10);
    setTimeout(() => {
      notification.style.transform = 'translateX(-50%) translateY(-100px)';
      setTimeout(() => notification.remove(), 300);
    }, duration);
  },
  
  checkAbsences() {
    if (!STUDENTS || STUDENTS.length === 0) return;
    const studentsWithAbsences = [];
    STUDENTS.forEach(student => {
      let absences = 0;
      ACADEMIC_DAYS.forEach(day => {
        if (attendanceData[`${student.id}-${day.date}`] === 'A') absences++;
      });
      if (absences >= 3) studentsWithAbsences.push({name: student.name, count: absences});
    });
    if (studentsWithAbsences.length > 0) {
      this.show(`${studentsWithAbsences.length} Ø·Ø§Ù„Ø¨Ø© ÙˆØµÙ„Ù† Ù„Ù€ 3 Ø£ÙŠØ§Ù… ØºÙŠØ§Ø¨ Ø£Ùˆ Ø£ÙƒØ«Ø±!`, 'alert', 6000);
    }
  }
};

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//  2. Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const Dashboard = {
  calculate() {
    if (!STUDENTS || STUDENTS.length === 0) return {totalStudents:0, presentToday:0, absentToday:0, attendanceRate:0, perfectAttendance:0, needsAttention:0};
    
    let presentToday = 0, absentToday = 0, perfectAttendance = 0, needsAttention = 0;
    const today = ACADEMIC_DAYS[ACADEMIC_DAYS.length - 1];
    
    STUDENTS.forEach(student => {
      const todayKey = `${student.id}-${today.date}`;
      if (attendanceData[todayKey] === 'P') presentToday++;
      else if (attendanceData[todayKey] === 'A') absentToday++;
      
      let absences = 0;
      ACADEMIC_DAYS.forEach(day => {
        if (attendanceData[`${student.id}-${day.date}`] === 'A') absences++;
      });
      
      if (absences === 0) perfectAttendance++;
      if (absences >= 3) needsAttention++;
    });
    
    return {
      totalStudents: STUDENTS.length,
      presentToday,
      absentToday,
      attendanceRate: STUDENTS.length > 0 ? Math.round((presentToday / STUDENTS.length) * 100) : 0,
      perfectAttendance,
      needsAttention
    };
  },
  
  render() {
    const container = document.getElementById('attendanceTableContainer');
    if (!container || !container.previousElementSibling) return;
    
    let dashboardDiv = document.getElementById('dashboardStats');
    if (!dashboardDiv) {
      dashboardDiv = document.createElement('div');
      dashboardDiv.id = 'dashboardStats';
      container.parentElement.insertBefore(dashboardDiv, container);
    }
    
    const stats = this.calculate();
    dashboardDiv.innerHTML = `
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:24px">
        <div style="background:linear-gradient(135deg,var(--blue-xs),var(--blue-lt));padding:20px;border-radius:16px;border:2px solid var(--blue);text-align:center">
          <div style="font-size:14px;color:var(--blue);font-weight:700;margin-bottom:8px">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª</div>
          <div style="font-size:36px;font-weight:900;color:var(--blue)">${stats.totalStudents}</div>
        </div>
        
        <div style="background:linear-gradient(135deg,var(--present-lt),#c6f6d5);padding:20px;border-radius:16px;border:2px solid var(--present);text-align:center">
          <div style="font-size:14px;color:var(--present);font-weight:700;margin-bottom:8px">Ù†Ø³Ø¨Ø© Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…</div>
          <div style="font-size:36px;font-weight:900;color:var(--present)">${stats.attendanceRate}%</div>
          <div style="font-size:12px;color:var(--gray-600);margin-top:4px">${stats.presentToday} Ù…Ù† ${stats.totalStudents}</div>
        </div>
        
        <div style="background:linear-gradient(135deg,#fef3c7,#fde68a);padding:20px;border-radius:16px;border:2px solid #f59e0b;text-align:center">
          <div style="font-size:14px;color:#d97706;font-weight:700;margin-bottom:8px">Ø­Ø¶ÙˆØ± Ù…Ø«Ø§Ù„ÙŠ ğŸ†</div>
          <div style="font-size:36px;font-weight:900;color:#d97706">${stats.perfectAttendance}</div>
          <div style="font-size:12px;color:var(--gray-600);margin-top:4px">Ø¨Ø¯ÙˆÙ† ØºÙŠØ§Ø¨</div>
        </div>
        
        <div style="background:linear-gradient(135deg,var(--absent-lt),#fecaca);padding:20px;border-radius:16px;border:2px solid var(--absent);text-align:center">
          <div style="font-size:14px;color:var(--absent);font-weight:700;margin-bottom:8px">ØªØ­ØªØ§Ø¬ Ù…ØªØ§Ø¨Ø¹Ø© âš ï¸</div>
          <div style="font-size:36px;font-weight:900;color:var(--absent)">${stats.needsAttention}</div>
          <div style="font-size:12px;color:var(--gray-600);margin-top:4px">3+ Ø£ÙŠØ§Ù… ØºÙŠØ§Ø¨</div>
        </div>
      </div>
    `;
  }
};

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//  3. Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø©
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

document.addEventListener('keydown', (e) => {
  if (e.ctrlKey && e.key === 'h') {
    e.preventDefault();
    if (typeof markAllPresent === 'function') markAllPresent();
    showToast('âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ± Ø§Ù„Ø¬Ù…ÙŠØ¹');
  }
  if (e.ctrlKey && e.key === 's') {
    e.preventDefault();
    showToast('ğŸ’¾ ØªÙ… Ø§Ù„Ø­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹');
  }
  if (e.ctrlKey && e.key === 'p') {
    e.preventDefault();
    window.print();
  }
  if (e.key === 'Escape') {
    const modal = document.getElementById('certificateModal');
    if (modal && modal.style.display === 'block') modal.style.display = 'none';
  }
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  COMPREHENSIVE DATA PERSISTENCE SYSTEM
//  Ù†Ø¸Ø§Ù… Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ø´Ø§Ù…Ù„ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const DataPersistence = {
  // Save all data to localStorage
  saveAll() {
    try {
      const data = {
        students: STUDENTS,
        attendance: attendanceData,
        notes: studentNotes,
        timestamp: new Date().toISOString(),
        version: '2.0'
      };
      
      localStorage.setItem('attendance_system_data', JSON.stringify(data));
      console.log('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', new Date().toLocaleString('ar-SA'));
      return true;
    } catch (e) {
      console.error('âŒ ÙØ´Ù„ Ø§Ù„Ø­ÙØ¸:', e);
      NotificationSystem.show('âš ï¸ ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
      return false;
    }
  },
  
  // Load all data from localStorage
  loadAll() {
    try {
      const stored = localStorage.getItem('attendance_system_data');
      if (!stored) {
        console.log('â„¹ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©');
        return false;
      }
      
      const data = JSON.parse(stored);
      
      // Restore students
      if (data.students && Array.isArray(data.students)) {
        STUDENTS.length = 0;
        STUDENTS.push(...data.students);
        console.log(`âœ… ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© ${STUDENTS.length} Ø·Ø§Ù„Ø¨Ø©`);
      }
      
      // Restore attendance
      if (data.attendance && typeof data.attendance === 'object') {
        Object.keys(attendanceData).forEach(key => delete attendanceData[key]);
        Object.assign(attendanceData, data.attendance);
        console.log(`âœ… ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±`);
      }
      
      // Restore notes
      if (data.notes && typeof data.notes === 'object') {
        Object.keys(studentNotes).forEach(key => delete studentNotes[key]);
        Object.assign(studentNotes, data.notes);
        console.log(`âœ… ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª`);
      }
      
      console.log('âœ… ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù†:', data.timestamp);
      NotificationSystem.show('âœ… ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©', 'success', 3000);
      
      return true;
    } catch (e) {
      console.error('âŒ ÙØ´Ù„ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', e);
      return false;
    }
  },
  
  // Export data to JSON file for download
  exportToFile() {
    try {
      const data = {
        students: STUDENTS,
        attendance: attendanceData,
        notes: studentNotes,
        exportDate: new Date().toISOString(),
        school: 'Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¨Ø¬Ø§Ø²Ø§Ù†',
        semester: 'Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠ 1447-1448 Ù‡Ù€'
      };
      
      const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `attendance-backup-${new Date().toISOString().split('T')[0]}.json`;
      a.click();
      URL.revokeObjectURL(url);
      
      NotificationSystem.show('âœ… ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©', 'success');
    } catch (e) {
      console.error('âŒ ÙØ´Ù„ Ø§Ù„ØªØµØ¯ÙŠØ±:', e);
      NotificationSystem.show('âŒ ÙØ´Ù„ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
    }
  },
  
  // Import data from JSON file
  importFromFile(fileInput) {
    const file = fileInput.files[0];
    if (!file) return;
    
    const reader = new FileReader();
    reader.onload = (e) => {
      try {
        const data = JSON.parse(e.target.result);
        
        if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©.')) {
          // Restore students
          if (data.students) {
            STUDENTS.length = 0;
            STUDENTS.push(...data.students);
          }
          
          // Restore attendance
          if (data.attendance) {
            Object.keys(attendanceData).forEach(key => delete attendanceData[key]);
            Object.assign(attendanceData, data.attendance);
          }
          
          // Restore notes
          if (data.notes) {
            Object.keys(studentNotes).forEach(key => delete studentNotes[key]);
            Object.assign(studentNotes, data.notes);
          }
          
          this.saveAll();
          updateAttendanceTable();
          renderStudentList();
          
          NotificationSystem.show('âœ… ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }
      } catch (e) {
        console.error('âŒ ÙØ´Ù„ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯:', e);
        NotificationSystem.show('âŒ ÙØ´Ù„ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
      }
    };
    reader.readAsText(file);
  },
  
  // Clear all data
  clearAll() {
    if (confirm('âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡!')) {
      if (confirm('âš ï¸ ØªØ£ÙƒÙŠØ¯ Ù†Ù‡Ø§Ø¦ÙŠ: Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!')) {
        localStorage.removeItem('attendance_system_data');
        STUDENTS.length = 0;
        Object.keys(attendanceData).forEach(key => delete attendanceData[key]);
        Object.keys(studentNotes).forEach(key => delete studentNotes[key]);
        
        updateAttendanceTable();
        renderStudentList();
        
        NotificationSystem.show('âœ… ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'success');
      }
    }
  }
};

// Auto-save every 30 seconds (more frequent)
setInterval(() => {
  DataPersistence.saveAll();
}, 30000);

// Save on any data change
function saveData() {
  DataPersistence.saveAll();
}

// Load data on page load
window.addEventListener('load', () => {
  console.log('ğŸ“‚ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©...');
  DataPersistence.loadAll();
  
  // Update UI after loading
  setTimeout(() => {
    if (typeof updateAttendanceTable === 'function') {
      updateAttendanceTable();
    }
    if (typeof renderStudentList === 'function') {
      renderStudentList();
    }
    if (typeof Dashboard !== 'undefined' && typeof Dashboard.render === 'function') {
      Dashboard.render();
    }
  }, 500);
});

// Save before page unload
window.addEventListener('beforeunload', () => {
  DataPersistence.saveAll();
});

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//  5. ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆØ§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

setTimeout(() => {
  Dashboard.render();
  setTimeout(() => NotificationSystem.checkAbsences(), 2000);
}, 1500);

// Update dashboard periodically
setInterval(() => Dashboard.render(), 30000);

// Show shortcuts helper
const helper = document.createElement('div');
helper.style.cssText = 'position:fixed;bottom:20px;left:20px;background:rgba(10,36,99,.95);color:#fff;padding:12px 16px;border-radius:12px;font-size:11px;font-weight:600;z-index:1000;cursor:pointer;transition:all .3s';
helper.innerHTML = 'âŒ¨ï¸ Ø§Ø®ØªØµØ§Ø±Ø§Øª';
helper.onclick = () => showToast('Ctrl+H=Ø­Ø¶ÙˆØ± Ø§Ù„ÙƒÙ„ | Ctrl+S=Ø­ÙØ¸ | Ctrl+P=Ø·Ø¨Ø§Ø¹Ø© | Esc=Ø¥ØºÙ„Ø§Ù‚', 8000);
document.body.appendChild(helper);

// Show cloud status indicator
const cloudStatus = document.createElement('div');
cloudStatus.id = 'cloudStatus';
cloudStatus.style.cssText = 'position:fixed;bottom:20px;right:20px;background:rgba(10,36,99,.95);color:#fff;padding:12px 16px;border-radius:12px;font-size:11px;font-weight:600;z-index:1000;display:flex;align-items:center;gap:8px';
if (isFirebaseEnabled) {
  cloudStatus.innerHTML = '<span style="width:8px;height:8px;border-radius:50%;background:#16a34a;box-shadow:0 0 8px #16a34a"></span><span>â˜ï¸ Ù…ØªØµÙ„ Ø¨Ø§Ù„Ø³Ø­Ø§Ø¨Ø©</span>';
} else {
  cloudStatus.innerHTML = '<span style="width:8px;height:8px;border-radius:50%;background:#d97706;box-shadow:0 0 8px #d97706"></span><span>ğŸ’¾ Ù…Ø­Ù„ÙŠ ÙÙ‚Ø·</span>';
}
document.body.appendChild(cloudStatus);

console.log('ğŸš€ Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© Ø¬Ø§Ù‡Ø²Ø©!');

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  PARENTS COMMUNICATION SYSTEM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function renderParentsList() {
  const container = document.getElementById('parentsListContainer');
  
  // Filter students with parent phones
  const studentsWithPhones = STUDENTS.filter(s => s.parentPhone && s.parentPhone.trim());
  
  if (studentsWithPhones.length === 0) {
    container.innerHTML = `
      <div style="background:#fff;padding:60px;border-radius:16px;border:1px solid var(--gray-200);text-align:center">
        <div style="font-size:64px;margin-bottom:16px">ğŸ“±</div>
        <div style="font-size:18px;font-weight:700;color:var(--navy);margin-bottom:8px">
          Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø±Ù‚Ø§Ù… Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø£Ù…ÙˆØ±
        </div>
        <div style="font-size:13px;color:var(--gray-600);margin-bottom:20px">
          Ø§Ø°Ù‡Ø¨ÙŠ Ù„ØªØ¨ÙˆÙŠØ¨ "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª" ÙˆØ£Ø¶ÙŠÙÙŠ Ø£Ø±Ù‚Ø§Ù… Ø£ÙˆÙ„ÙŠØ§Ø¡ Ø§Ù„Ø£Ù…ÙˆØ± Ù„Ù„Ø·Ø§Ù„Ø¨Ø§Øª
        </div>
        <button class="btn btn-primary" onclick="showTab('students')">
          ğŸ“š Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª
        </button>
      </div>
    `;
    return;
  }
  
  let html = '<div style="display:grid;gap:16px">';
  
  studentsWithPhones.forEach(student => {
    // Get attendance stats
    let presentCount = 0;
    let absentCount = 0;
    let totalDays = 0;
    
    ACADEMIC_DAYS.forEach(day => {
      const key = `${student.id}-${day.date}`;
      const status = attendanceData[key];
      if (status) {
        totalDays++;
        if (status === 'P') presentCount++;
        if (status === 'A') absentCount++;
      }
    });
    
    const attendanceRate = totalDays > 0 ? Math.round((presentCount / totalDays) * 100) : 0;
    const initials = student.name.split(' ').slice(0,2).map(w=>w[0]).join('');
    
    // Format phone number for WhatsApp
    let formattedPhone = student.parentPhone.replace(/\s/g, '');
    if (formattedPhone.startsWith('05')) {
      formattedPhone = '966' + formattedPhone.substring(1);
    } else if (formattedPhone.startsWith('+966')) {
      formattedPhone = formattedPhone.substring(1);
    } else if (!formattedPhone.startsWith('966')) {
      formattedPhone = '966' + formattedPhone;
    }
    
    html += `
      <div style="background:#fff;padding:20px;border-radius:12px;border:1px solid var(--gray-200);box-shadow:var(--shadow-sm)">
        <div style="display:flex;align-items:center;gap:16px;margin-bottom:16px">
          <div style="width:60px;height:60px;border-radius:50%;background:${student.color};display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:800;color:#fff;flex-shrink:0">
            ${initials}
          </div>
          <div style="flex:1">
            <div style="font-size:16px;font-weight:700;color:var(--navy);margin-bottom:4px">${student.name}</div>
            <div style="font-size:12px;color:var(--gray-600);margin-bottom:4px">
              ${student.grade === 'first' ? 'Ø§Ù„Ø£ÙˆÙ„ Ø«Ø§Ù†ÙˆÙŠ' : student.grade === 'second' ? 'Ø§Ù„Ø«Ø§Ù†ÙŠ Ø«Ø§Ù†ÙˆÙŠ' : 'Ø§Ù„Ø«Ø§Ù„Ø« Ø«Ø§Ù†ÙˆÙŠ'} - Ø´Ø¹Ø¨Ø© ${student.section}
            </div>
            <div style="font-size:13px;color:var(--blue);font-weight:600;direction:ltr;text-align:right">
              ğŸ“± ${student.parentPhone}
            </div>
          </div>
          <div style="text-align:center">
            <div style="font-size:24px;font-weight:900;color:${attendanceRate >= 90 ? 'var(--present)' : attendanceRate >= 75 ? 'var(--excused)' : 'var(--absent)'};margin-bottom:4px">${attendanceRate}%</div>
            <div style="font-size:11px;color:var(--gray-600)">Ù†Ø³Ø¨Ø© Ø§Ù„Ø­Ø¶ÙˆØ±</div>
          </div>
        </div>
        
        <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:8px">
          <button onclick="sendWhatsApp('${formattedPhone}', '${student.name}', ${presentCount}, ${absentCount}, ${attendanceRate})" style="padding:12px;background:linear-gradient(135deg,#25D366,#128C7E);color:#fff;border:none;border-radius:10px;font-family:'Cairo',sans-serif;font-size:13px;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;transition:all .2s" onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 4px 12px rgba(37,211,102,.3)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
            <span style="font-size:18px">ğŸ’¬</span>
            <span>ÙˆØ§ØªØ³Ø§Ø¨</span>
          </button>
          <button onclick="sendSMS('${student.parentPhone}', '${student.name}')" style="padding:12px;background:linear-gradient(135deg,var(--blue),var(--navy));color:#fff;border:none;border-radius:10px;font-family:'Cairo',sans-serif;font-size:13px;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;transition:all .2s" onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 4px 12px rgba(30,94,243,.3)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
            <span style="font-size:18px">ğŸ“±</span>
            <span>Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ©</span>
          </button>
        </div>
      </div>
    `;
  });
  
  html += '</div>';
  container.innerHTML = html;
}

function sendWhatsApp(phone, studentName, present, absent, rate) {
  const message = `Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ… ÙˆØ±Ø­Ù…Ø© Ø§Ù„Ù„Ù‡ ÙˆØ¨Ø±ÙƒØ§ØªÙ‡

ÙˆÙ„ÙŠ Ø£Ù…Ø± Ø§Ù„Ø·Ø§Ù„Ø¨Ø©: ${studentName}

Ù†ÙˆØ¯ Ø¥Ø¹Ù„Ø§Ù…ÙƒÙ… Ø¨Ø³Ø¬Ù„ Ø­Ø¶ÙˆØ± Ø§Ø¨Ù†ØªÙƒÙ…:

âœ… Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¶ÙˆØ±: ${present} ÙŠÙˆÙ…
âŒ Ø£ÙŠØ§Ù… Ø§Ù„ØºÙŠØ§Ø¨: ${absent} ÙŠÙˆÙ…
ğŸ“Š Ù†Ø³Ø¨Ø© Ø§Ù„Ø­Ø¶ÙˆØ±: ${rate}%

${rate < 75 ? 'âš ï¸ Ù†Ù†ØµØ­ Ø¨Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø¶ÙˆØ± Ø§Ù„Ø·Ø§Ù„Ø¨Ø© Ø¨Ø´ÙƒÙ„ Ù…Ù†ØªØ¸Ù….' : rate >= 90 ? 'ğŸŒŸ Ù†Ø´ÙƒØ± Ù„ÙƒÙ… Ø­Ø±ØµÙƒÙ… Ø¹Ù„Ù‰ Ø§Ù†ØªØ¸Ø§Ù… Ø§Ø¨Ù†ØªÙƒÙ….' : ''}

Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¨Ø¬Ø§Ø²Ø§Ù†
Ù„Ù„ØªÙˆØ§ØµÙ„: [Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©]`;

  const encodedMessage = encodeURIComponent(message);
  const whatsappUrl = `https://wa.me/${phone}?text=${encodedMessage}`;
  
  window.open(whatsappUrl, '_blank');
  NotificationSystem.show('âœ… Ø¬Ø§Ø±ÙŠ ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨...', 'success');
}

function quickWhatsApp(phone, studentName) {
  const message = `Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ… ÙˆØ±Ø­Ù…Ø© Ø§Ù„Ù„Ù‡ ÙˆØ¨Ø±ÙƒØ§ØªÙ‡

ÙˆÙ„ÙŠ Ø£Ù…Ø± Ø§Ù„Ø·Ø§Ù„Ø¨Ø©: ${studentName}

Ù†ÙˆØ¯ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ÙƒÙ… Ø¨Ø®ØµÙˆØµ Ø§Ø¨Ù†ØªÙƒÙ… ÙÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¨Ø¬Ø§Ø²Ø§Ù†.

Ù„Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø£Ùˆ Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø±ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§.

Ø´ÙƒØ±Ø§Ù‹ Ù„ØªØ¹Ø§ÙˆÙ†ÙƒÙ…`;

  const encodedMessage = encodeURIComponent(message);
  const whatsappUrl = `https://wa.me/${phone}?text=${encodedMessage}`;
  
  window.open(whatsappUrl, '_blank');
  NotificationSystem.show('âœ… Ø¬Ø§Ø±ÙŠ ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨...', 'success');
}

function sendSMS(phone, studentName) {
  const message = `ÙˆÙ„ÙŠ Ø£Ù…Ø± ${studentName}: ÙŠØ±Ø¬Ù‰ Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø¶ÙˆØ± Ø§Ø¨Ù†ØªÙƒÙ… ÙÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¨Ø¬Ø§Ø²Ø§Ù†. Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø±: [Ø±Ù‚Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©]`;
  const encodedMessage = encodeURIComponent(message);
  
  // For mobile devices
  const smsUrl = `sms:${phone}?body=${encodedMessage}`;
  window.location.href = smsUrl;
  
  NotificationSystem.show('âœ… Ø¬Ø§Ø±ÙŠ ÙØªØ­ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„...', 'success');
}

// Update renderParentsList when tab is opened
const originalShowTab = showTab;
showTab = function(tabName) {
  originalShowTab(tabName);
  if (tabName === 'parents') {
    setTimeout(() => renderParentsList(), 100);
  }
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  TEAM MEMBERS MANAGEMENT SYSTEM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let editingMemberPassword = null;

function openAddMemberModal() {
  editingMemberPassword = null;
  document.getElementById('memberModalTitle').textContent = 'Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯';
  document.getElementById('memberName').value = '';
  document.getElementById('memberRole').value = '';
  document.getElementById('memberPassword').value = '';
  document.getElementById('memberModal').style.display = 'block';
}

function editMember(password) {
  const member = ADMIN_PASSWORDS[password];
  if (!member) return;
  
  editingMemberPassword = password;
  document.getElementById('memberModalTitle').textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø¶Ùˆ';
  document.getElementById('memberName').value = member.name;
  document.getElementById('memberRole').value = member.role;
  document.getElementById('memberPassword').value = password;
  document.getElementById('memberModal').style.display = 'block';
}

function closeMemberModal() {
  document.getElementById('memberModal').style.display = 'none';
  editingMemberPassword = null;
}

function saveMember() {
  const name = document.getElementById('memberName').value.trim();
  const role = document.getElementById('memberRole').value;
  const password = document.getElementById('memberPassword').value.trim();
  
  // Validation
  if (!name) {
    NotificationSystem.show('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ø¶Ùˆ', 'warning');
    return;
  }
  
  if (!role) {
    NotificationSystem.show('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ', 'warning');
    return;
  }
  
  if (!password) {
    NotificationSystem.show('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ', 'warning');
    return;
  }
  
  if (!/^\d{4}$/.test(password)) {
    NotificationSystem.show('âš ï¸ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 4 Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø·', 'warning');
    return;
  }
  
  // Check if password already exists (only if adding new or changing password)
  if (password !== editingMemberPassword && ADMIN_PASSWORDS[password]) {
    NotificationSystem.show('âš ï¸ Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ù‚Ø¨Ù„! Ø§Ø®ØªØ± Ø±Ù‚Ù… Ø¢Ø®Ø±', 'error');
    return;
  }
  
  // If editing, remove old password entry
  if (editingMemberPassword && editingMemberPassword !== password) {
    delete ADMIN_PASSWORDS[editingMemberPassword];
  }
  
  // Save member
  ADMIN_PASSWORDS[password] = {
    name: name,
    role: role
  };
  
  // Save to localStorage
  saveTeamMembers();
  
  // Update UI
  renderAdminDashboard();
  closeMemberModal();
  
  NotificationSystem.show(editingMemberPassword ? 'âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø¶Ùˆ' : 'âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ø¶Ùˆ Ø¨Ù†Ø¬Ø§Ø­', 'success');
}

function deleteMember(password, name) {
  if (confirm(`âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù ${name} Ù…Ù† Ø§Ù„ÙØ±ÙŠÙ‚ØŸ`)) {
    // Check if this is the only member
    const memberCount = Object.keys(ADMIN_PASSWORDS).length;
    if (memberCount <= 1) {
      NotificationSystem.show('âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ø¢Ø®Ø± Ø¹Ø¶Ùˆ ÙÙŠ Ø§Ù„ÙØ±ÙŠÙ‚', 'warning');
      return;
    }
    
    // Check if deleting current user
    if (currentUser && ADMIN_PASSWORDS[password] && ADMIN_PASSWORDS[password].name === currentUser.name) {
      NotificationSystem.show('âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ø­Ø³Ø§Ø¨Ùƒ Ø§Ù„Ø®Ø§Øµ ÙˆØ£Ù†Øª Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„', 'warning');
      return;
    }
    
    delete ADMIN_PASSWORDS[password];
    saveTeamMembers();
    renderAdminDashboard();
    NotificationSystem.show(`âœ… ØªÙ… Ø­Ø°Ù ${name} Ù…Ù† Ø§Ù„ÙØ±ÙŠÙ‚`, 'success');
  }
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STUDENT NOTES SYSTEM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let studentNotes = {}; // {studentId: [{date, text, type, author}]}
let currentNoteStudent = null;

function openStudentNotes(studentId) {
  const student = STUDENTS.find(s => s.id === studentId);
  if (!student) return;
  
  currentNoteStudent = student;
  const today = ACADEMIC_DAYS[ACADEMIC_DAYS.length - 1];
  const todayKey = `${student.id}-${today.date}`;
  const status = attendanceData[todayKey] || '';
  
  const initials = student.name.split(' ').slice(0,2).map(w=>w[0]).join('');
  
  document.getElementById('noteStudentAvatar').textContent = initials;
  document.getElementById('noteStudentAvatar').style.background = student.color;
  document.getElementById('noteStudentName').textContent = student.name;
  document.getElementById('noteStudentId').textContent = student.id;
  
  const statusDiv = document.getElementById('noteStudentStatus');
  const statusMap = {
    'P': {text: 'Ø­ Ø­Ø§Ø¶Ø±Ø©', bg: 'var(--present-lt)', color: 'var(--present)'},
    'A': {text: 'Øº ØºØ§Ø¦Ø¨Ø©', bg: 'var(--absent-lt)', color: 'var(--absent)'},
    'E': {text: 'Ø¹ Ø¨Ø¹Ø°Ø±', bg: 'var(--excused-lt)', color: 'var(--excused)'},
    'L': {text: 'Øª Ù…ØªØ£Ø®Ø±Ø©', bg: 'var(--late-lt)', color: 'var(--late)'}
  };
  
  if (status && statusMap[status]) {
    statusDiv.textContent = `ğŸ“… Ø§Ù„ÙŠÙˆÙ… | ${statusMap[status].text}`;
    statusDiv.style.background = statusMap[status].bg;
    statusDiv.style.color = statusMap[status].color;
  } else {
    statusDiv.textContent = 'ğŸ“… Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„';
    statusDiv.style.background = 'var(--gray-100)';
    statusDiv.style.color = 'var(--gray-600)';
  }
  
  document.getElementById('newNoteText').value = '';
  renderPreviousNotes(studentId);
  document.getElementById('studentNotesModal').style.display = 'block';
}

function closeStudentNotes() {
  document.getElementById('studentNotesModal').style.display = 'none';
  currentNoteStudent = null;
}

function addStudentNote() {
  if (!currentNoteStudent) return;
  
  const text = document.getElementById('newNoteText').value.trim();
  const type = document.getElementById('noteType').value;
  
  if (!text) {
    NotificationSystem.show('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ù…Ù„Ø§Ø­Ø¸Ø©', 'warning');
    return;
  }
  
  if (!studentNotes[currentNoteStudent.id]) {
    studentNotes[currentNoteStudent.id] = [];
  }
  
  studentNotes[currentNoteStudent.id].unshift({
    date: new Date().toLocaleString('ar-SA'),
    text: text,
    type: type,
    author: currentUser ? currentUser.name : 'Ø§Ù„Ù…Ø¹Ù„Ù…Ø©'
  });
  
  document.getElementById('newNoteText').value = '';
  renderPreviousNotes(currentNoteStudent.id);
  NotificationSystem.show('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©', 'success');
}

function renderPreviousNotes(studentId) {
  const container = document.getElementById('previousNotesList');
  const notes = studentNotes[studentId] || [];
  
  if (notes.length === 0) {
    container.innerHTML = '<div style="text-align:center;padding:40px;color:var(--gray-400)"><div style="font-size:48px;margin-bottom:8px">ğŸ“</div><div style="font-size:13px">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø³Ø§Ø¨Ù‚Ø©</div></div>';
    return;
  }
  
  let html = '<div style="display:grid;gap:12px">';
  notes.forEach((note, index) => {
    const typeColors = {
      positive: {bg: 'var(--present-lt)', icon: 'ğŸŒŸ', border: 'var(--present)'},
      neutral: {bg: 'var(--blue-xs)', icon: 'ğŸ“', border: 'var(--blue)'},
      warning: {bg: 'var(--absent-lt)', icon: 'âš ï¸', border: 'var(--absent)'}
    };
    
    const color = typeColors[note.type] || typeColors.neutral;
    
    html += `
      <div style="background:${color.bg};padding:16px;border-radius:12px;border-right:4px solid ${color.border}">
        <div style="display:flex;align-items:start;justify-content:space-between;margin-bottom:8px">
          <div style="font-size:20px">${color.icon}</div>
          <div style="font-size:10px;color:var(--gray-600)">${note.date}</div>
        </div>
        <div style="font-size:13px;color:var(--gray-800);margin-bottom:8px;line-height:1.6">${note.text}</div>
        <div style="font-size:11px;color:var(--gray-600)">Ø¨ÙˆØ§Ø³Ø·Ø©: ${note.author}</div>
      </div>
    `;
  });
  html += '</div>';
  
  container.innerHTML = html;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INTERACTIVE CHARTS SYSTEM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let todayChart = null;
let weekChart = null;

function initializeCharts() {
  const stats = calculateDashboardStats();
  
  // Today Pie Chart
  const todayCtx = document.getElementById('todayPieChart');
  if (todayCtx && !todayChart) {
    todayChart = new Chart(todayCtx, {
      type: 'doughnut',
      data: {
        labels: ['Ø­Ø¶ÙˆØ±', 'ØºÙŠØ§Ø¨', 'Ø¹Ø°Ø±', 'ØªØ£Ø®ÙŠØ±'],
        datasets: [{
          data: [stats.today.present, stats.today.absent, stats.today.excused, stats.today.late],
          backgroundColor: ['#16a34a', '#dc2626', '#d97706', '#7c3aed'],
          borderWidth: 0
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: {
          legend: {
            position: 'bottom',
            labels: {font: {family: 'Cairo', size: 12}}
          }
        }
      }
    });
  }
  
  // Week Bar Chart
  const weekCtx = document.getElementById('weekBarChart');
  if (weekCtx && !weekChart) {
    weekChart = new Chart(weekCtx, {
      type: 'bar',
      data: {
        labels: stats.week.days,
        datasets: [{
          label: 'Ù†Ø³Ø¨Ø© Ø§Ù„Ø­Ø¶ÙˆØ± %',
          data: stats.week.rates,
          backgroundColor: '#1e5ef3',
          borderRadius: 8
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        scales: {
          y: {
            beginAtZero: true,
            max: 100,
            ticks: {font: {family: 'Cairo'}}
          },
          x: {
            ticks: {font: {family: 'Cairo'}}
          }
        },
        plugins: {
          legend: {
            labels: {font: {family: 'Cairo'}}
          }
        }
      }
    });
  }
}

function calculateDashboardStats() {
  if (!STUDENTS || STUDENTS.length === 0) {
    return {
      today: {present: 0, absent: 0, excused: 0, late: 0, rate: 0},
      week: {days: [], rates: []},
      month: {rate: 0}
    };
  }
  
  const today = ACADEMIC_DAYS[ACADEMIC_DAYS.length - 1];
  let todayP = 0, todayA = 0, todayE = 0, todayL = 0;
  
  STUDENTS.forEach(s => {
    const key = `${s.id}-${today.date}`;
    const status = attendanceData[key];
    if (status === 'P') todayP++;
    else if (status === 'A') todayA++;
    else if (status === 'E') todayE++;
    else if (status === 'L') todayL++;
  });
  
  const todayRate = STUDENTS.length > 0 ? Math.round((todayP / STUDENTS.length) * 100) : 0;
  
  // Week stats
  const weekDays = ACADEMIC_DAYS.slice(-5);
  const weekLabels = weekDays.map(d => d.day);
  const weekRates = weekDays.map(day => {
    let dayP = 0;
    STUDENTS.forEach(s => {
      if (attendanceData[`${s.id}-${day.date}`] === 'P') dayP++;
    });
    return STUDENTS.length > 0 ? Math.round((dayP / STUDENTS.length) * 100) : 0;
  });
  
  return {
    today: {present: todayP, absent: todayA, excused: todayE, late: todayL, rate: todayRate},
    week: {days: weekLabels, rates: weekRates},
    month: {rate: todayRate}
  };
}

function updateDashboardStats() {
  const stats = calculateDashboardStats();
  
  document.getElementById('todayAttendanceRate').textContent = stats.today.rate + '%';
  document.getElementById('weekAttendanceRate').textContent = Math.round(stats.week.rates.reduce((a,b)=>a+b,0)/stats.week.rates.length) + '%';
  document.getElementById('monthAttendanceRate').textContent = stats.month.rate + '%';
  document.getElementById('totalStudentsCount').textContent = STUDENTS.length;
  
  // Update charts
  if (todayChart) {
    todayChart.data.datasets[0].data = [stats.today.present, stats.today.absent, stats.today.excused, stats.today.late];
    todayChart.update();
  }
  
  if (weekChart) {
    weekChart.data.datasets[0].data = stats.week.rates;
    weekChart.update();
  }
}

function renderStudentsNotesTable() {
  const container = document.getElementById('studentsNotesTable');
  if (!container || !STUDENTS || STUDENTS.length === 0) return;
  
  const today = ACADEMIC_DAYS[ACADEMIC_DAYS.length - 1];
  
  let html = '<div style="display:grid;gap:8px">';
  STUDENTS.slice(0, 10).forEach(student => {
    const todayKey = `${student.id}-${today.date}`;
    const status = attendanceData[todayKey] || '';
    const initials = student.name.split(' ').slice(0,2).map(w=>w[0]).join('');
    const notes = studentNotes[student.id] || [];
    const latestNote = notes[0];
    
    const statusMap = {
      'P': {text: 'Ø­', bg: 'var(--present-lt)', color: 'var(--present)'},
      'A': {text: 'Øº', bg: 'var(--absent-lt)', color: 'var(--absent)'},
      'E': {text: 'Ø¹', bg: 'var(--excused-lt)', color: 'var(--excused)'},
      'L': {text: 'Øª', bg: 'var(--late-lt)', color: 'var(--late)'}
    };
    
    const statusInfo = status && statusMap[status] ? statusMap[status] : {text: 'â€”', bg: 'var(--gray-100)', color: 'var(--gray-400)'};
    
    html += `
      <div style="display:flex;align-items:center;gap:12px;padding:12px;background:var(--gray-50);border-radius:12px;transition:all .2s;cursor:pointer" onmouseover="this.style.background='var(--blue-xs)'" onmouseout="this.style.background='var(--gray-50)'" onclick="openStudentNotes('${student.id}')">
        <div style="width:40px;height:40px;border-radius:50%;background:${student.color};display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:800;color:#fff">${initials}</div>
        <div style="flex:1">
          <div style="font-size:13px;font-weight:700;color:var(--navy)">${student.name}</div>
          ${latestNote ? `<div style="font-size:11px;color:var(--gray-600);margin-top:2px">ğŸ’¬ "${latestNote.text.substring(0,30)}${latestNote.text.length>30?'...':''}"</div>` : '<div style="font-size:11px;color:var(--gray-400);margin-top:2px">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª</div>'}
        </div>
        <div style="display:flex;align-items:center;gap:8px">
          <div style="width:32px;height:32px;border-radius:8px;background:${statusInfo.bg};color:${statusInfo.color};display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700">${statusInfo.text}</div>
          <div style="font-size:11px;color:var(--gray-400)">${notes.length} Ù…Ù„Ø§Ø­Ø¸Ø©</div>
        </div>
      </div>
    `;
  });
  html += '</div>';
  
  container.innerHTML = html;
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  QUICK ATTENDANCE METHODS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let quickListData = {};

// QR Scanner Functions
function openQRScanner() {
  document.getElementById('qrScannerModal').style.display = 'block';
  NotificationSystem.show('ğŸ“¸ Ù‚Ø±ÙŠØ¨Ø§Ù‹: Ø³ØªØªÙ…ÙƒÙ† Ù…Ù† Ù…Ø³Ø­ Ø±Ù…ÙˆØ² QR', 'info', 3000);
}

function closeQRScanner() {
  document.getElementById('qrScannerModal').style.display = 'none';
}

// Manual Entry Functions
function openManualEntry() {
  document.getElementById('manualEntryModal').style.display = 'block';
  document.getElementById('manualEntryText').value = '';
  document.getElementById('manualEntryText').focus();
}

function closeManualEntry() {
  document.getElementById('manualEntryModal').style.display = 'none';
}

function processManualEntry() {
  const text = document.getElementById('manualEntryText').value.trim();
  if (!text) {
    NotificationSystem.show('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø£Ø³Ù…Ø§Ø¡ Ø£Ùˆ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø·Ø§Ù„Ø¨Ø§Øª', 'warning');
    return;
  }
  
  const lines = text.split('\n').map(l => l.trim()).filter(l => l);
  let matched = 0;
  const today = ACADEMIC_DAYS[ACADEMIC_DAYS.length - 1];
  
  lines.forEach(line => {
    const student = STUDENTS.find(s => 
      s.name.includes(line) || 
      s.id.includes(line) || 
      line.includes(s.name)
    );
    
    if (student) {
      const key = `${student.id}-${today.date}`;
      attendanceData[key] = 'P';
      matched++;
    }
  });
  
  if (matched > 0) {
    updateAttendanceTable();
    AutoBackup.save();
    NotificationSystem.show(`âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ± ${matched} Ø·Ø§Ù„Ø¨Ø©`, 'success');
    closeManualEntry();
  } else {
    NotificationSystem.show('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£ÙŠ Ø·Ø§Ù„Ø¨Ø© Ù…Ø·Ø§Ø¨Ù‚Ø©', 'error');
  }
}

// Voice Input Functions
let isRecording = false;

function openVoiceInput() {
  document.getElementById('voiceInputModal').style.display = 'block';
  isRecording = false;
}

function closeVoiceInput() {
  document.getElementById('voiceInputModal').style.display = 'none';
  isRecording = false;
}

function startVoiceRecording() {
  if (isRecording) {
    stopVoiceRecording();
    return;
  }
  
  isRecording = true;
  document.getElementById('voiceStartBtn').innerHTML = 'â¹ï¸';
  document.getElementById('voiceStatus').textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„...';
  document.getElementById('voiceAnimIcon').style.animation = 'pulse 1s infinite';
  
  // Simulate voice recognition (would use Web Speech API in production)
  NotificationSystem.show('ğŸ¤ Ù‚Ø±ÙŠØ¨Ø§Ù‹: Ø³ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØª', 'info', 3000);
  
  setTimeout(() => {
    if (isRecording) stopVoiceRecording();
  }, 5000);
}

function stopVoiceRecording() {
  isRecording = false;
  document.getElementById('voiceStartBtn').innerHTML = 'ğŸ¤';
  document.getElementById('voiceStatus').textContent = 'Ø§Ø¶ØºØ· Ù„Ù„Ø¨Ø¯Ø¡';
  document.getElementById('voiceAnimIcon').style.animation = 'none';
}

// Quick List Functions
let selectedQuickListDate = null;

function openQuickList() {
  if (!STUDENTS || STUDENTS.length === 0) {
    NotificationSystem.show('âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ø§Ù„Ø¨Ø§Øª ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…', 'warning');
    return;
  }
  
  const modal = document.getElementById('quickListModal');
  const dateSelect = document.getElementById('quickListDateSelect');
  
  // Populate date dropdown
  let dateOptions = '';
  ACADEMIC_DAYS.forEach((day, index) => {
    const isToday = index === ACADEMIC_DAYS.length - 1;
    dateOptions += `<option value="${index}" ${isToday ? 'selected' : ''}>${day.hijri} (${day.day}) - ${day.date}</option>`;
  });
  dateSelect.innerHTML = dateOptions;
  
  // Set selected date to today by default
  selectedQuickListDate = ACADEMIC_DAYS[ACADEMIC_DAYS.length - 1];
  
  // Render students list
  renderQuickListStudents();
  
  modal.style.display = 'block';
}

function updateQuickListDate() {
  const dateSelect = document.getElementById('quickListDateSelect');
  const selectedIndex = parseInt(dateSelect.value);
  selectedQuickListDate = ACADEMIC_DAYS[selectedIndex];
  
  // Re-render students with new date
  renderQuickListStudents();
}

function renderQuickListStudents() {
  const container = document.getElementById('quickListStudents');
  
  quickListData = {};
  
  let html = '<div style="display:grid;gap:8px">';
  
  STUDENTS.forEach(student => {
    const currentKey = `${student.id}-${selectedQuickListDate.date}`;
    const currentStatus = attendanceData[currentKey] || '';
    quickListData[student.id] = currentStatus;
    
    const initials = student.name.split(' ').slice(0,2).map(w=>w[0]).join('');
    
    html += `
      <div style="display:flex;align-items:center;gap:12px;padding:12px;background:var(--gray-50);border-radius:12px;border:2px solid transparent;transition:all .2s" id="quickStudent${student.id}">
        <div style="width:40px;height:40px;border-radius:50%;background:${student.color};display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:800;color:#fff">${initials}</div>
        <div style="flex:1">
          <div style="font-size:13px;font-weight:700;color:var(--navy)">${student.name}</div>
          <div style="font-size:10px;color:var(--gray-600)">${student.id}</div>
        </div>
        <div style="display:flex;gap:6px">
          <button onclick="setQuickStatus('${student.id}', 'P')" class="quick-status-btn ${currentStatus==='P'?'active':''}" data-status="P" style="width:32px;height:32px;border-radius:8px;border:2px solid var(--present);background:${currentStatus==='P'?'var(--present)':'#fff'};color:${currentStatus==='P'?'#fff':'var(--present)'};font-size:11px;font-weight:700;cursor:pointer;transition:all .2s">Ø­</button>
          <button onclick="setQuickStatus('${student.id}', 'A')" class="quick-status-btn ${currentStatus==='A'?'active':''}" data-status="A" style="width:32px;height:32px;border-radius:8px;border:2px solid var(--absent);background:${currentStatus==='A'?'var(--absent)':'#fff'};color:${currentStatus==='A'?'#fff':'var(--absent)'};font-size:11px;font-weight:700;cursor:pointer;transition:all .2s">Øº</button>
          <button onclick="setQuickStatus('${student.id}', 'E')" class="quick-status-btn ${currentStatus==='E'?'active':''}" data-status="E" style="width:32px;height:32px;border-radius:8px;border:2px solid var(--excused);background:${currentStatus==='E'?'var(--excused)':'#fff'};color:${currentStatus==='E'?'#fff':'var(--excused)'};font-size:11px;font-weight:700;cursor:pointer;transition:all .2s">Ø¹</button>
          <button onclick="setQuickStatus('${student.id}', 'L')" class="quick-status-btn ${currentStatus==='L'?'active':''}" data-status="L" style="width:32px;height:32px;border-radius:8px;border:2px solid var(--late);background:${currentStatus==='L'?'var(--late)':'#fff'};color:${currentStatus==='L'?'#fff':'var(--late)'};font-size:11px;font-weight:700;cursor:pointer;transition:all .2s">Øª</button>
        </div>
      </div>
    `;
  });
  
  html += '</div>';
  container.innerHTML = html;
}

function closeQuickList() {
  document.getElementById('quickListModal').style.display = 'none';
  quickListData = {};
}

function setQuickStatus(studentId, status) {
  quickListData[studentId] = status;
  
  // Update UI
  const row = document.getElementById('quickStudent' + studentId);
  const buttons = row.querySelectorAll('.quick-status-btn');
  
  buttons.forEach(btn => {
    const btnStatus = btn.getAttribute('data-status');
    if (btnStatus === status) {
      btn.classList.add('active');
      if (status === 'P') {
        btn.style.background = 'var(--present)';
        btn.style.color = '#fff';
      } else if (status === 'A') {
        btn.style.background = 'var(--absent)';
        btn.style.color = '#fff';
      } else if (status === 'E') {
        btn.style.background = 'var(--excused)';
        btn.style.color = '#fff';
      } else if (status === 'L') {
        btn.style.background = 'var(--late)';
        btn.style.color = '#fff';
      }
    } else {
      btn.classList.remove('active');
      btn.style.background = '#fff';
      if (btnStatus === 'P') btn.style.color = 'var(--present)';
      else if (btnStatus === 'A') btn.style.color = 'var(--absent)';
      else if (btnStatus === 'E') btn.style.color = 'var(--excused)';
      else if (btnStatus === 'L') btn.style.color = 'var(--late)';
    }
  });
}

function quickSelectAll(status) {
  STUDENTS.forEach(student => {
    quickListData[student.id] = status;
    setQuickStatus(student.id, status);
  });
  NotificationSystem.show(`âœ… ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„ ÙƒÙ€ ${status==='P'?'Ø­Ø§Ø¶Ø±':'ØºØ§Ø¦Ø¨'}`, 'success', 2000);
}

function quickClearAll() {
  STUDENTS.forEach(student => {
    quickListData[student.id] = '';
    const row = document.getElementById('quickStudent' + student.id);
    const buttons = row.querySelectorAll('.quick-status-btn');
    buttons.forEach(btn => {
      btn.classList.remove('active');
      btn.style.background = '#fff';
      const btnStatus = btn.getAttribute('data-status');
      if (btnStatus === 'P') btn.style.color = 'var(--present)';
      else if (btnStatus === 'A') btn.style.color = 'var(--absent)';
      else if (btnStatus === 'E') btn.style.color = 'var(--excused)';
      else if (btnStatus === 'L') btn.style.color = 'var(--late)';
    });
  });
  NotificationSystem.show('ğŸ”„ ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ­Ø¯ÙŠØ¯Ø§Øª', 'info', 2000);
}

function saveQuickList() {
  if (!selectedQuickListDate) {
    NotificationSystem.show('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØ§Ø±ÙŠØ®', 'warning');
    return;
  }
  
  let count = 0;
  
  Object.keys(quickListData).forEach(studentId => {
    const status = quickListData[studentId];
    if (status) {
      const key = `${studentId}-${selectedQuickListDate.date}`;
      attendanceData[key] = status;
      count++;
    }
  });
  
  if (count > 0) {
    updateAttendanceTable();
    saveData();
    Dashboard.render();
    NotificationSystem.show(`âœ… ØªÙ… Ø­ÙØ¸ Ø­Ø¶ÙˆØ± ${count} Ø·Ø§Ù„Ø¨Ø© Ù„ØªØ§Ø±ÙŠØ® ${selectedQuickListDate.hijri}`, 'success');
    closeQuickList();
  } else {
    NotificationSystem.show('âš ï¸ Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø£ÙŠ Ø­Ø§Ù„Ø©', 'warning');
  }
}


</script>

</body>
</html>